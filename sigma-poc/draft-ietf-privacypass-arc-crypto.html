<!DOCTYPE html>
<html lang="en" class="Internet-Draft">
<head>
<meta charset="utf-8">
<meta content="Common,Latin" name="scripts">
<meta content="initial-scale=1.0" name="viewport">
<title>Anonymous Rate-Limited Credentials Cryptography</title>
<meta content="Cathie Yun" name="author">
<meta content="Christopher A. Wood" name="author">
<meta content="Armando Faz-Hernandez" name="author">
<meta content="
       This document specifies the Anonymous Rate-Limited Credential (ARC) protocol,
a specialization of keyed-verification anonymous credentials with support for
rate limiting. ARC credentials can be presented from client to server up to
some fixed number of times, where each presentation is cryptographically bound
to client secrets and application-specific public information, such that each
presentation is unlinkable from the others as well as the original credential
creation. ARC is useful in applications where a server needs to throttle or
rate-limit access from anonymous clients. 
    " name="description">
<meta content="xml2rfc 3.31.0" name="generator">
<meta content="draft-ietf-privacypass-arc-crypto-latest" name="ietf.draft">
<!-- Generator version information:
  xml2rfc 3.31.0
    Python 3.12.12
    ConfigArgParse 1.7
    google-i18n-address 3.1.1
    intervaltree 3.2.1
    Jinja2 3.1.6
    lxml 6.0.2
    platformdirs 4.5.1
    pycountry 24.6.1
    PyYAML 6.0.3
    requests 2.32.5
    wcwidth 0.3.0
-->
<link href="draft-ietf-privacypass-arc-crypto.xml" rel="alternate" type="application/rfc+xml">
<link href="#copyright" rel="license">
<style type="text/css">@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0460-052F, U+1C80-1C88, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
}
@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}
@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-vietnamese.woff2') format('woff2');
  unicode-range: U+0102-0103, U+0110-0111, U+1EA0-1EF9, U+20AB;
}
@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}

@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0460-052F, U+1C80-1C88, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-cyrillic.woff2') format('woff2');
  unicode-range: U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-vietnamese.woff2') format('woff2');
  unicode-range: U+0102-0103, U+0110-0111, U+1EA0-1EF9, U+20AB;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}

@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0460-052F, U+1C80-1C88, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-cyrillic.woff2') format('woff2');
  unicode-range: U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-vietnamese.woff2') format('woff2');
  unicode-range: U+0102-0103, U+0110-0111, U+1EA0-1EF9, U+20AB;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 600;
  font-display: swap;
  src: local('Lora SemiBold'), local('Lora-SemiBold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-semibold-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}

@font-face {
  font-family: 'Oxygen Mono';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Oxygen Mono'), local('OxygenMono-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/oxygenmono-regular-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-02BA, U+02BD-02C5, U+02C7-02CC, U+02CE-02D7, U+02DD-02FF, U+0304, U+0308, U+0329, U+1D00-1DBF, U+1E00-1E9F, U+1EF2-1EFF, U+2020, U+20A0-20AB, U+20AD-20C0, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Oxygen Mono';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Oxygen Mono'), local('OxygenMono-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/oxygenmono-regular-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+0304, U+0308, U+0329, U+2000-206F, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}
}

@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: italic;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-italic-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0460-052F, U+1C80-1C8A, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: italic;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-italic-cyrillic.woff2') format('woff2');
  unicode-range: U+0301, U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: italic;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-italic-greek.woff2') format('woff2');
  unicode-range: U+0370-0377, U+037A-037F, U+0384-038A, U+038C, U+038E-03A1, U+03A3-03FF;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: italic;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-italic-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-02BA, U+02BD-02C5, U+02C7-02CC, U+02CE-02D7, U+02DD-02FF, U+0304, U+0308, U+0329, U+1D00-1DBF, U+1E00-1E9F, U+1EF2-1EFF, U+2020, U+20A0-20AB, U+20AD-20C0, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: italic;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-italic-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+0304, U+0308, U+0329, U+2000-206F, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: normal;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-regular-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0460-052F, U+1C80-1C8A, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: normal;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-regular-cyrillic.woff2') format('woff2');
  unicode-range: U+0301, U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: normal;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-regular-greek.woff2') format('woff2');
  unicode-range: U+0370-0377, U+037A-037F, U+0384-038A, U+038C, U+038E-03A1, U+03A3-03FF;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: normal;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-regular-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-02BA, U+02BD-02C5, U+02C7-02CC, U+02CE-02D7, U+02DD-02FF, U+0304, U+0308, U+0329, U+1D00-1DBF, U+1E00-1E9F, U+1EF2-1EFF, U+2020, U+20A0-20AB, U+20AD-20C0, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: normal;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-regular-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+0304, U+0308, U+0329, U+2000-206F, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}

:root {
  color-scheme: light dark;
  --background-color: #fff;
  --text-color: #222;
  --title-color: #191919;
  --link-color: #2a6496;
  --highlight-color: #f9f9f9;
  --line-color: #eee;
  --pilcrow-weak: #ddd;
  --pilcrow-strong: #bbb;
  --small-font-size: 14.5px;
  --font-mono: 'Oxygen Mono', monospace;
  --font-title: "Sofia Sans Semi Condensed", sans-serif;
  scrollbar-color: #bbb #eee;
}
body {
  max-width: 600px;
  margin: 75px auto;
  padding: 0 5px;
  color: var(--text-color);
  background-color: var(--background-color);
  font: 16px/22px "Lora", serif;
  scroll-behavior: smooth;
}

.ears {
  display: none;
}

/* headings */
section {
  clear: both;
}
.section-number {
  padding-right: 0.5em;
}
h1, h2, h3, h4, h5, h6 {
  font-family: var(--font-title);
  font-weight: 680;
  margin: 0.8em 0 0.3em;
  font-size-adjust: 0.5;
  color: var(--title-color);
}
h1#title {
  font-size: 32px;
  line-height: 40px;
  clear: both;
}
h1#title, h1#rfcnum {
  margin: 1.5em 0 0.2em;
}
h1#rfcnum + h1#title {
  margin: 0.2em 0;
}

h1, h2, h3 {
  font-size: 22px;
  line-height: 27px;
}
h4, h5, h6 {
  font-size: 20px;
  line-height: 24px;
}

/* general structure */
.author {
  padding-bottom: 0.3em;
  vertical-align: top;
}
#abstract+p {
  font-size: 18px;
  line-height: 24px;
}
#abstract+p code, #abstract+p samp, #abstract+p tt {
  font-size: 16px;
  line-height: 0;
}

p {
  padding: 0;
  margin: 0.5em 0;
  text-align: left;
}
div {
  margin: 0;
}
.alignRight.art-text {
  background-color: var(--highlight-color);
  border: 1px solid var(--line-color);
  border-radius: 3px;
  padding: 0.5em 1em 0;
  margin-bottom: 0.5em;
}
.alignRight.art-text pre {
  padding: 0;
  width: auto;
}
.alignRight {
  margin: 1em 0;
}
.alignRight > *:first-child {
  border: none;
  margin: 0;
  float: right;
  clear: both;
}
.alignRight > *:nth-child(2) {
  clear: both;
  display: block;
  border: none;
}
svg {
  display: block;
}
/* font-family isn't space-separated, but =~ will have to do */
svg[font-family~="monospace" i], svg [font-family~="monospace" i] {
  font-family: var(--font-mono);
}
.alignCenter.art-text {
  background-color: var(--highlight-color);
  border: 1px solid var(--line-color);
  border-radius: 3px;
  padding: 0.5em 1em 0;
  margin-bottom: 0.5em;
}
.alignCenter.art-text pre {
  padding: 0;
  width: auto;
}
.alignCenter {
  margin: 1em 0;
}
.alignCenter > *:first-child {
  border: none;
  /* this isn't optimal, but it's an existence proof.  PrinceXML doesn't
     support flexbox yet.
  */
  display: table;
  margin: 0 auto;
}

/* lists */
ol, ul {
  padding: 0;
  margin: 0 0 0.5em 2em;
  & :is(ol, ul) {
    margin-left: 1em;
  }
}
li {
  margin: 0 0 0.25em 0;
}
ul.empty, .ulEmpty {
  list-style-type: none;
  & li {
    margin-top: 0.5em;
  }
}
:is(ul, ol).compact, .ulCompact, .olCompact {
  margin: 0 0 0 2em;
  & li {
    margin: 0;
    & :first-child { margin-top: 0; }
    & :last-child { margin-bottom: 0; }
  }
}

/* definition lists */
dl {
  clear: left;
  --indent: 3ch;
  /* --indent: attr(indent ch); not supported in any browser, but we can dream */
  &.olPercent {
    --indent: 5ch;
    & > dt {
      min-width: calc(var(--indent) - 2ch);
    }
  }
  &.olPercent > dt {
    float: none;
  }

  dl > dd > & {
    margin-top: 0.5em;
    margin-bottom: 0;
  }
}
dl:not(.dlNewline) > dt {
  float: left;
  margin-right: 2ch;
  min-width: 8ch;
}
dl > dd {
  margin-bottom: .8em;
  margin-left: var(--indent) !important; /* stupid element overrides */
  min-height: 2ex;
}
:is(dl.compact, .dlCompact) > dd {
  margin-bottom: 0;
  & > :is(:first-child, .break:first-child + *) {
    margin-top: 0;
  }
  & > :is(:last-child) {
    margin-bottom: 0;
  }
}
:is(dd, span).break {
  display: none;
}

/* links */
a, a[href].selfRef:hover {
  text-decoration: none;
}
a[href] {
  color: var(--link-color);
}
a[href].selfRef, .iref + a[href].internal {
  color: var(--text-color);
}
a[href]:hover {
  text-decoration: underline;
}
a[href].selfRef:hover {
  background-color: var(--highlight-color);
}
a.xref:is(.cite, .auto), :is(#status-of-memo, #copyright) a {
  white-space: nowrap;
}

/* Figures */
tt, code, pre {
  background-color: var(--highlight-color);
  font: 14px/22px var(--font-mono);
}
tt, code {
  /* changing the font for inline elements leads to different ascender
     and descender heights; as we want to retain baseline alignment,
     remove leading to avoid altering the final height of lines
     note: this fails if these blocks take an entire line,
     a different solution would be great */
  line-height: 0;
}
:is(h1, h2, h3, h4, h5, h6) :is(tt, code) {
  font-size: 84%;
}
pre {
  border: 1px solid var(--line-color);
  font-size: 13.5px;
  line-height: 16px;
  letter-spacing: -0.2px;
  margin: 5px;
  padding: 5px;
}
img {
  max-width: 100%;
}
figure {
  margin: 0.5em 0;
  padding: 0;
}
figure blockquote {
  margin: 0.8em 0.4em 0.4em;
}
figcaption, caption {
  font-style: italic;
  margin: 0.5em 1.5em;
  text-align: left;
  caption-side: bottom;
}
@media screen {
  /* Auto-collapse boilerplate. */
  :is(#status-of-memo, #copyright) p {
    margin: -2px 0;
    max-height: 0;
    transition: max-height 2s ease, margin 0.5s ease 0.5s;
    overflow: hidden;
  }
  :is(#status-of-memo, #copyright):hover p,
  :is(#status-of-memo, #copyright) h2:target ~ p {
    margin: 0.5em 0;
    max-height: 500px;
    overflow: auto;
  }
  pre, svg {
    display: inline-block;
    /* In the horizontal direction, sometimes people make over-sized figures.
       Scrollbars for those is therefore necessary: auto adds them as necessary..
       In the vertical direction, the line-height can combine with the font
       asender/descender height to produce scrollbars: hidden avoids that. */
    overflow: auto hidden;
  }
  pre {
    max-width: 100%;
    width: calc(100% - 22px - 1em);
  }
  svg {
    max-width: calc(100% - 22px - 1em);
  }
  figure pre {
    display: block;
    width: calc(100% - 25px);
  }
  :is(pre, svg) + .pilcrow {
    display: inline-block;
    vertical-align: text-bottom;
    padding-bottom: 8px;
  }
}

/* aside, blockquote */
aside, blockquote {
  margin-left: 0;
  padding: 0 2em;
  font-style: italic;
}
blockquote {
  margin: 1em 0;
  border-left: 2px var(--pilcrow-strong) solid;
}
cite {
  display: block;
  text-align: right;
  font-style: italic;
}

/* tables */
table {
  width: auto;
  max-width: 100%;
  margin: 0 0 1em;
  border-collapse: collapse;
}
table.right {
  margin-left: auto;
}
table.center {
  margin-left: auto;
  margin-right: auto;
}
table.left {
  margin-right: auto;
}
table .text-left {
  text-align: left;
}
table .text-center {
  text-align: center;
}
table .text-right {
  text-align: right;
}

thead, tbody {
  border: 1px solid var(--line-color);
}
th, td {
  text-align: left;
  vertical-align: top;
  padding: 5px 10px;
}
th {
  background-color: var(--line-color);
}
:is(tr:nth-child(2n), thead+tbody > tr:nth-child(2n+1)) > td {
  background-color: var(--background-color);
}
:is(tr:nth-child(2n+1), thead+tbody > tr:nth-child(2n)) > td {
  background-color: var(--highlight-color);
}
table caption {
  margin: 0;
  padding: 3px 0 3px 1em;
}
table p {
  margin: 0;
}

/* pilcrow */
a.pilcrow {
  margin-left: 3px;
  opacity: 0.2;
  user-select: none;
  &[href] {
    color: var(--pilcrow-weak);
    &:hover { text-decoration: none; }
  }
}
@media not print {
  :hover > a.pilcrow, a.pilcrow:focus {
    opacity: 1;
  }
  a.pilcrow[href]:hover {
    color: var(--pilcrow-strong);
    background-color: transparent;
  }
}
@media print {
  a.pilcrow {
    display: none;
  }
}

/* misc */
hr {
  border: 0;
  border-top: 1px solid var(--line-color);
}
.bcp14 {
  font-variant: small-caps;
  font-weight: 600;
  font-size: var(--small-font-size);
}
.role {
  font-variant: all-small-caps;
}
sub, sup {
  line-height: 1;
  font-size: 80%;
}

/* info block */
#identifiers {
  margin: 0;
  font-size: var(--small-font-size);
  line-height: 18px;
  --identifier-width: 15ch;
  & dt {
    width: var(--identifier-width);
    min-width: var(--identifier-width);
    clear: left;
    float: left;
    text-align: right;
    margin-right: 1ch;
  }
  & dd {
    margin: 0;
    margin-left: calc(1em + var(--identifier-width)) !important;
    min-width: 5em;
  }
  & .authors {
    & .author {
      display: inline-block;
      margin-right: 1.5em;
    }
    & .org {
      font-style: italic;
    }
  }
}

/* The prepared/rendered info at the very bottom of the page */
.docInfo {
  color: #999;
  font-size: 0.9em;
  font-style: italic;
  margin-top: 2em;
}
.docInfo .prepared {
  float: right;
}

/* table of contents */
#toc {
  padding: 0.75em 0 2em 0;
  margin-bottom: 1em;

  & nav {
    & ul {
      margin: 0 0.5em 0 0;
      padding: 0;
      list-style: none;
    }
    & li {
      line-height: 1.3em;
      margin: 2px 0;
      padding-left: 1.2em;
      text-indent: -1.2em;
    }
  }
  & a.xref {
    white-space: normal;
  }
}

.references {
  & > dt {
    text-align: right;
    font-weight: bold;
    min-width: 10ch;
    margin-right: 1.5ch;
    &:target::before {
      content: "⇒";
      margin: 0 10px 0 -25px;
    }
  }
  & > dd {
    margin-left: 12ch !important;
    overflow: visible;
    & .refInstance {
      margin-bottom: 0.8em;
    }
    & .ascii {
      margin-bottom: 0.25em;
    }
  }
}

#rfc\.index\.index + ul {
  margin-left: 0;
}

/* authors */
address.vcard {
  font-style: normal;
  max-width: 20em;
  margin: 1em auto 1em 0;

  & .nameRole {
    font-weight: 700;
    margin-left: 0;
  }
  & .label {
    margin: 0.5em 0;
  }
  & .type {
    display: none;
  }
  & .alternative-contact {
    margin: 0.5em 0 0.25em 0;
  }
  & .non-ascii {
    margin: 0 0 0 2em;
  }
  & div.left {
    text-align: left;
  }
  & div.right {
    text-align: right;
  }
}

hr.addr {
  border-top: 1px dashed;
  margin: 0;
  color: #ddd;
  max-width: calc(100% - 16px);
}
@media (min-width: 500px) {
  #authors-addresses > section {
    column-count: 2;
    column-gap: 20px;
  }
  #authors-addresses > section > h2 {
    column-span: all;
  }
  /* hack for break-inside: avoid-column */
  #authors-addresses address {
    display: inline-block;
    break-inside: avoid-column;
  }
}

/* Comments */
.rfcEditorRemove p:first-of-type {
  font-style: italic;
}
.cref {
  background-color: rgba(249, 232, 105, 0.3);
  padding: 2px 4px;
}
.crefSource {
  font-style: italic;
}

@media screen {
  #toc nav {
    font-family: var(--font-title);
    font-weight: 360;
    & > ul { margin-bottom: 2em; }
    & ul {
      margin: 0 0 0 4px;
      & :is(p, li) {
        margin: 2px 0;
      }
    }
  }
  #toc a.toplink {
    float: right;
  }
}
@media not screen {
  #toc a.toplink {
    display: none;
  }
}


/* TOC layout for smaller screens */
@media screen and (max-width: 929px) {
  #toc {
    position: fixed;
    z-index: 2;
    top: 0;
    right: 0;
    padding: 1px 0 0 0;
    margin: 0;
    border-bottom: 1px solid #ccc;
    opacity: 0.6;
  }
  #toc h2 {
    margin: 0;
    padding: 2px 0 2px 6px;
    padding-right: 1em;
    font-size: 18px;
    line-height: 24px;
    min-width: 190px;
    text-align: right;
    background-color: #444;
    color: white;
    cursor: pointer;
    &::before { /* css hamburger */
      float: right;
      position: relative;
      width: 1em;
      height: 1px;
      left: -164px;
      margin: 8px 0 0 0;
      background: white none repeat scroll 0 0;
      box-shadow: 0 4px 0 0 white, 0 8px 0 0 white;
      content: "";
    }
  }
  #toc nav {
    display: none;
    background-color: var(--background-color);
    padding: 0.5em 1em 1em;
    overflow: auto;
    overscroll-behavior: contain;
    height: calc(100vh - 48px);
    border-left: 1px solid #ddd;
  }
  #toc.active {
    opacity: 1;
    & nav { display: block; }
  }
  /* Make the collapsed ToC header render white on gray also when it's a link */
  #toc h2 a,
  #toc h2 a:is(:link, :focus, :hover),
  #toc a.toplink,
  #toc a.toplink:hover {
    color: white;
    background-color: #444;
    text-decoration: none;
  }
  #toc a.toplink {
    margin: 2px 0.5em 0;
  }
}

/* TOC layout for wide screens */
@media screen and (min-width: 930px) {
  body {
    padding-right: 360px;
    padding-right: calc(min(180px + 20%, 500px));
  }
  #toc {
    position: fixed;
    bottom: 0;
    right: 0;
    right: calc(50vw - 480px);
    width: 312px;
    margin: 0;
    padding: 0;
    z-index: 1;
  }
  #toc h2 {
    margin: 0;
    padding: 0.25em 1em 1em 0;
  }
  #toc nav {
    display: block;
    height: calc(90vh - 84px);
    bottom: 0;
    padding: 0.5em 0 2em;
    overflow: auto;
    overscroll-behavior: contain;
    scrollbar-width: thin;
  }
  img { /* future proofing */
    max-width: 100%;
    height: auto;
  }
  #toc a.toplink {
    margin: 8px 0.5em 0;
  }
}

/* pagination */
@media print {
  body {
    width: 100%;
  }
  p {
    orphans: 3;
    widows: 3;
  }
  #n-copyright-notice {
    border-bottom: none;
  }
  #toc, #n-introduction {
    page-break-before: always;
  }
  #toc {
    border-top: none;
    padding-top: 0;
  }
  figure, pre, .vcard {
    page-break-inside: avoid;
  }
  h1, h2, h3, h4, h5, h6 {
    page-break-after: avoid;
  }
  :is(h2, h3, h4, h5, h6)+*, dd {
    page-break-before: avoid;
  }
  pre {
    white-space: pre-wrap;
    word-wrap: break-word;
    font-size: 10pt;
  }
  table {
    border: 1px solid #ddd;
  }
  td {
    border-top: 1px solid #ddd;
  }
}

@page :first {
  padding-top: 0;
  @top-left {
    content: normal;
    border: none;
  }
  @top-center {
    content: normal;
    border: none;
  }
  @top-right {
    content: normal;
    border: none;
  }
}

@page {
  size: A4;
  margin-bottom: 45mm;
  padding-top: 20px;
}

/* Dark mode. */
@media (prefers-color-scheme: dark) {
:root {
  --background-color: #121212;
  --text-color: #f0f0f0;
  --title-color: #fff;
  --link-color: #4da4f0;
  --highlight-color: #282828;
  --line-color: #444;
  --pilcrow-weak: #444;
  --pilcrow-strong: #666;
  scrollbar-color: #777 #333;
}
}

/* SVG Trick: a prefix match works because only black and white are allowed */
svg :is([stroke="black"], [stroke^="#000"]) {
  stroke: var(--text-color);
}
svg :is([stroke="white"], [stroke^="#fff"]) {
  stroke: var(--background-color);
}
svg :is([fill="black"], [fill^="#000"], :not([fill])) {
  fill: var(--text-color);
}
svg :is([fill="white"], [fill^="#fff"]) {
  fill: var(--background-color);
}
</style>

</head>
<body class="xml2rfc">
<table class="ears">
<thead><tr>
<td class="left">Internet-Draft</td>
<td class="center">ARC Cryptography</td>
<td class="right">February 2026</td>
</tr></thead>
<tfoot><tr>
<td class="left">Yun, et al.</td>
<td class="center">Expires 31 August 2026</td>
<td class="right">[Page]</td>
</tr></tfoot>
</table>
<div id="external-metadata" class="document-information"></div>
<div id="internal-metadata" class="document-information">
<dl id="identifiers">
<dt class="label-workgroup">Workgroup:</dt>
<dd class="workgroup">Network Working Group</dd>
<dt class="label-internet-draft">Internet-Draft:</dt>
<dd class="internet-draft">draft-ietf-privacypass-arc-crypto-latest</dd>
<dt class="label-published">Published:</dt>
<dd class="published">
<time datetime="2026-02-27" class="published">27 February 2026</time>
    </dd>
<dt class="label-intended-status">Intended Status:</dt>
<dd class="intended-status">Informational</dd>
<dt class="label-expires">Expires:</dt>
<dd class="expires"><time datetime="2026-08-31">31 August 2026</time></dd>
<dt class="label-authors">Authors:</dt>
<dd class="authors">
<div class="author">
      <div class="author-name">C. Yun</div>
<div class="org">Apple, Inc.</div>
</div>
<div class="author">
      <div class="author-name">C. A. Wood</div>
<div class="org">Apple, Inc.</div>
</div>
<div class="author">
      <div class="author-name">A. Faz-Hernandez</div>
<div class="org">Cloudflare</div>
</div>
</dd>
</dl>
</div>
<h1 id="title">Anonymous Rate-Limited Credentials Cryptography</h1>
<section id="section-abstract">
      <h2 id="abstract"><a href="#abstract" class="selfRef">Abstract</a></h2>
<p id="section-abstract-1">This document specifies the Anonymous Rate-Limited Credential (ARC) protocol,
a specialization of keyed-verification anonymous credentials with support for
rate limiting. ARC credentials can be presented from client to server up to
some fixed number of times, where each presentation is cryptographically bound
to client secrets and application-specific public information, such that each
presentation is unlinkable from the others as well as the original credential
creation. ARC is useful in applications where a server needs to throttle or
rate-limit access from anonymous clients.<a href="#section-abstract-1" class="pilcrow">¶</a></p>
</section>
<section class="note rfcEditorRemove" id="section-note.1">
      <h2 id="name-about-this-document">
<a href="#name-about-this-document" class="section-name selfRef">About This Document</a>
      </h2>
<p id="section-note.1-1">This note is to be removed before publishing as an RFC.<a href="#section-note.1-1" class="pilcrow">¶</a></p>
<p id="section-note.1-2">
        The latest revision of this draft can be found at <span><a href="https://ietf-wg-privacypass.github.io/draft-arc/draft-ietf-privacypass-arc-crypto.html">https://ietf-wg-privacypass.github.io/draft-arc/draft-ietf-privacypass-arc-crypto.html</a></span>.
        Status information for this document may be found at <span><a href="https://datatracker.ietf.org/doc/draft-ietf-privacypass-arc-crypto/">https://datatracker.ietf.org/doc/draft-ietf-privacypass-arc-crypto/</a></span>.<a href="#section-note.1-2" class="pilcrow">¶</a></p>
<p id="section-note.1-3">
        Discussion of this document takes place on the
        PRIVACYPASS Privacy Pass mailing list (<span><a href="mailto:privacy-pass@ietf.org">mailto:privacy-pass@ietf.org</a></span>),
        which is archived at <span><a href="https://mailarchive.ietf.org/arch/browse/privacy-pass">https://mailarchive.ietf.org/arch/browse/privacy-pass</a></span>.
        Subscribe at <span><a href="https://www.ietf.org/mailman/listinfo/privacy-pass/">https://www.ietf.org/mailman/listinfo/privacy-pass/</a></span>.<a href="#section-note.1-3" class="pilcrow">¶</a></p>
<p id="section-note.1-4">Source for this draft and an issue tracker can be found at
        <span><a href="https://github.com/ietf-wg-privacypass/draft-arc">https://github.com/ietf-wg-privacypass/draft-arc</a></span>.<a href="#section-note.1-4" class="pilcrow">¶</a></p>
</section>
<div id="status-of-memo">
<section id="section-boilerplate.1">
        <h2 id="name-status-of-this-memo">
<a href="#name-status-of-this-memo" class="section-name selfRef">Status of This Memo</a>
        </h2>
<p id="section-boilerplate.1-1">
        This Internet-Draft is submitted in full conformance with the
        provisions of BCP 78 and BCP 79.<a href="#section-boilerplate.1-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-2">
        Internet-Drafts are working documents of the Internet Engineering Task
        Force (IETF). Note that other groups may also distribute working
        documents as Internet-Drafts. The list of current Internet-Drafts is
        at <span><a href="https://datatracker.ietf.org/drafts/current/">https://datatracker.ietf.org/drafts/current/</a></span>.<a href="#section-boilerplate.1-2" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-3">
        Internet-Drafts are draft documents valid for a maximum of six months
        and may be updated, replaced, or obsoleted by other documents at any
        time. It is inappropriate to use Internet-Drafts as reference
        material or to cite them other than as "work in progress."<a href="#section-boilerplate.1-3" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-4">
        This Internet-Draft will expire on 31 August 2026.<a href="#section-boilerplate.1-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="copyright">
<section id="section-boilerplate.2">
        <h2 id="name-copyright-notice">
<a href="#name-copyright-notice" class="section-name selfRef">Copyright Notice</a>
        </h2>
<p id="section-boilerplate.2-1">
            Copyright (c) 2026 IETF Trust and the persons identified as the
            document authors. All rights reserved.<a href="#section-boilerplate.2-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.2-2">
            This document is subject to BCP 78 and the IETF Trust's Legal
            Provisions Relating to IETF Documents
            (<span><a href="https://trustee.ietf.org/license-info">https://trustee.ietf.org/license-info</a></span>) in effect on the date of
            publication of this document. Please review these documents
            carefully, as they describe your rights and restrictions with
            respect to this document. Code Components extracted from this
            document must include Revised BSD License text as described in
            Section 4.e of the Trust Legal Provisions and are provided without
            warranty as described in the Revised BSD License.<a href="#section-boilerplate.2-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="toc">
<section id="section-toc.1">
        <a href="#" onclick="scroll(0,0)" class="toplink">▲</a><h2 id="name-table-of-contents">
<a href="#name-table-of-contents" class="section-name selfRef">Table of Contents</a>
        </h2>
<nav class="toc"><ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1">
            <p id="section-toc.1-1.1.1" class="keepWithNext"><a href="#section-1" class="auto internal xref">1</a>.  <a href="#name-introduction" class="internal xref">Introduction</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2">
            <p id="section-toc.1-1.2.1" class="keepWithNext"><a href="#section-2" class="auto internal xref">2</a>.  <a href="#name-conventions-and-definitions" class="internal xref">Conventions and Definitions</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.1">
                <p id="section-toc.1-1.2.2.1.1" class="keepWithNext"><a href="#section-2.1" class="auto internal xref">2.1</a>.  <a href="#name-notation-and-terminology" class="internal xref">Notation and Terminology</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3">
            <p id="section-toc.1-1.3.1"><a href="#section-3" class="auto internal xref">3</a>.  <a href="#name-preliminaries" class="internal xref">Preliminaries</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.1">
                <p id="section-toc.1-1.3.2.1.1"><a href="#section-3.1" class="auto internal xref">3.1</a>.  <a href="#name-prime-order-group" class="internal xref">Prime-Order Group</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4">
            <p id="section-toc.1-1.4.1"><a href="#section-4" class="auto internal xref">4</a>.  <a href="#name-arc-protocol" class="internal xref">ARC Protocol</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.1">
                <p id="section-toc.1-1.4.2.1.1"><a href="#section-4.1" class="auto internal xref">4.1</a>.  <a href="#name-key-generation" class="internal xref">Key Generation</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.2">
                <p id="section-toc.1-1.4.2.2.1"><a href="#section-4.2" class="auto internal xref">4.2</a>.  <a href="#name-issuance" class="internal xref">Issuance</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.2.2.1">
                    <p id="section-toc.1-1.4.2.2.2.1.1"><a href="#section-4.2.1" class="auto internal xref">4.2.1</a>.  <a href="#name-credential-request" class="internal xref">Credential Request</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.2.2.2">
                    <p id="section-toc.1-1.4.2.2.2.2.1"><a href="#section-4.2.2" class="auto internal xref">4.2.2</a>.  <a href="#name-credential-response" class="internal xref">Credential Response</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.2.2.3">
                    <p id="section-toc.1-1.4.2.2.2.3.1"><a href="#section-4.2.3" class="auto internal xref">4.2.3</a>.  <a href="#name-finalize-credential" class="internal xref">Finalize Credential</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.3">
                <p id="section-toc.1-1.4.2.3.1"><a href="#section-4.3" class="auto internal xref">4.3</a>.  <a href="#name-presentation" class="internal xref">Presentation</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.3.2.1">
                    <p id="section-toc.1-1.4.2.3.2.1.1"><a href="#section-4.3.1" class="auto internal xref">4.3.1</a>.  <a href="#name-presentation-state" class="internal xref">Presentation State</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.3.2.2">
                    <p id="section-toc.1-1.4.2.3.2.2.1"><a href="#section-4.3.2" class="auto internal xref">4.3.2</a>.  <a href="#name-presentation-construction" class="internal xref">Presentation Construction</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.3.2.3">
                    <p id="section-toc.1-1.4.2.3.2.3.1"><a href="#section-4.3.3" class="auto internal xref">4.3.3</a>.  <a href="#name-presentation-verification" class="internal xref">Presentation Verification</a></p>
</li>
                </ul>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5">
            <p id="section-toc.1-1.5.1"><a href="#section-5" class="auto internal xref">5</a>.  <a href="#name-zero-knowledge-proofs" class="internal xref">Zero-Knowledge Proofs</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.1">
                <p id="section-toc.1-1.5.2.1.1"><a href="#section-5.1" class="auto internal xref">5.1</a>.  <a href="#name-credentialrequest-proof" class="internal xref">CredentialRequest Proof</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.1.2.1">
                    <p id="section-toc.1-1.5.2.1.2.1.1"><a href="#section-5.1.1" class="auto internal xref">5.1.1</a>.  <a href="#name-credentialrequest-proof-cre" class="internal xref">CredentialRequest Proof Creation</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.1.2.2">
                    <p id="section-toc.1-1.5.2.1.2.2.1"><a href="#section-5.1.2" class="auto internal xref">5.1.2</a>.  <a href="#name-credentialrequest-proof-ver" class="internal xref">CredentialRequest Proof Verification</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.2">
                <p id="section-toc.1-1.5.2.2.1"><a href="#section-5.2" class="auto internal xref">5.2</a>.  <a href="#name-credentialresponse-proof" class="internal xref">CredentialResponse Proof</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.2.2.1">
                    <p id="section-toc.1-1.5.2.2.2.1.1"><a href="#section-5.2.1" class="auto internal xref">5.2.1</a>.  <a href="#name-credentialresponse-proof-cr" class="internal xref">CredentialResponse Proof Creation</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.2.2.2">
                    <p id="section-toc.1-1.5.2.2.2.2.1"><a href="#section-5.2.2" class="auto internal xref">5.2.2</a>.  <a href="#name-credentialresponse-proof-ve" class="internal xref">CredentialResponse Proof Verification</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.3">
                <p id="section-toc.1-1.5.2.3.1"><a href="#section-5.3" class="auto internal xref">5.3</a>.  <a href="#name-presentation-proof" class="internal xref">Presentation Proof</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.3.2.1">
                    <p id="section-toc.1-1.5.2.3.2.1.1"><a href="#section-5.3.1" class="auto internal xref">5.3.1</a>.  <a href="#name-presentation-proof-creation" class="internal xref">Presentation Proof Creation</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.3.2.2">
                    <p id="section-toc.1-1.5.2.3.2.2.1"><a href="#section-5.3.2" class="auto internal xref">5.3.2</a>.  <a href="#name-presentation-proof-verifica" class="internal xref">Presentation Proof Verification</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.4">
                <p id="section-toc.1-1.5.2.4.1"><a href="#section-5.4" class="auto internal xref">5.4</a>.  <a href="#name-range-proof-for-arbitrary-v" class="internal xref">Range Proof for Arbitrary Values</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.4.2.1">
                    <p id="section-toc.1-1.5.2.4.2.1.1"><a href="#section-5.4.1" class="auto internal xref">5.4.1</a>.  <a href="#name-range-proof-creation" class="internal xref">Range Proof Creation</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.4.2.2">
                    <p id="section-toc.1-1.5.2.4.2.2.1"><a href="#section-5.4.2" class="auto internal xref">5.4.2</a>.  <a href="#name-range-proof-verification" class="internal xref">Range Proof Verification</a></p>
</li>
                </ul>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6">
            <p id="section-toc.1-1.6.1"><a href="#section-6" class="auto internal xref">6</a>.  <a href="#name-ciphersuites" class="internal xref">Ciphersuites</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.1">
                <p id="section-toc.1-1.6.2.1.1"><a href="#section-6.1" class="auto internal xref">6.1</a>.  <a href="#name-arcp-256" class="internal xref">ARC(P-256)</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.2">
                <p id="section-toc.1-1.6.2.2.1"><a href="#section-6.2" class="auto internal xref">6.2</a>.  <a href="#name-random-scalar-generation" class="internal xref">Random Scalar Generation</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.2.2.1">
                    <p id="section-toc.1-1.6.2.2.2.1.1"><a href="#section-6.2.1" class="auto internal xref">6.2.1</a>.  <a href="#name-rejection-sampling" class="internal xref">Rejection Sampling</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.2.2.2">
                    <p id="section-toc.1-1.6.2.2.2.2.1"><a href="#section-6.2.2" class="auto internal xref">6.2.2</a>.  <a href="#name-random-number-generation-us" class="internal xref">Random Number Generation Using Extra Random Bits</a></p>
</li>
                </ul>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7">
            <p id="section-toc.1-1.7.1"><a href="#section-7" class="auto internal xref">7</a>.  <a href="#name-security-considerations" class="internal xref">Security Considerations</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.1">
                <p id="section-toc.1-1.7.2.1.1"><a href="#section-7.1" class="auto internal xref">7.1</a>.  <a href="#name-credential-request-unlinkab" class="internal xref">Credential Request Unlinkability</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.2">
                <p id="section-toc.1-1.7.2.2.1"><a href="#section-7.2" class="auto internal xref">7.2</a>.  <a href="#name-credential-issuance-unlinka" class="internal xref">Credential Issuance Unlinkability</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.3">
                <p id="section-toc.1-1.7.2.3.1"><a href="#section-7.3" class="auto internal xref">7.3</a>.  <a href="#name-presentation-unlinkability" class="internal xref">Presentation Unlinkability</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.4">
                <p id="section-toc.1-1.7.2.4.1"><a href="#section-7.4" class="auto internal xref">7.4</a>.  <a href="#name-timing-leaks" class="internal xref">Timing Leaks</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8">
            <p id="section-toc.1-1.8.1"><a href="#section-8" class="auto internal xref">8</a>.  <a href="#name-alternatives-considered" class="internal xref">Alternatives considered</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9">
            <p id="section-toc.1-1.9.1"><a href="#section-9" class="auto internal xref">9</a>.  <a href="#name-iana-considerations" class="internal xref">IANA Considerations</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10">
            <p id="section-toc.1-1.10.1"><a href="#section-10" class="auto internal xref">10</a>. <a href="#name-test-vectors" class="internal xref">Test Vectors</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10.2.1">
                <p id="section-toc.1-1.10.2.1.1"><a href="#section-10.1" class="auto internal xref">10.1</a>.  <a href="#name-arcv1-p256" class="internal xref">ARCV1-P256</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11">
            <p id="section-toc.1-1.11.1"><a href="#section-11" class="auto internal xref">11</a>. <a href="#name-acknowledgments" class="internal xref">Acknowledgments</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.12">
            <p id="section-toc.1-1.12.1"><a href="#section-12" class="auto internal xref">12</a>. <a href="#name-references" class="internal xref">References</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.12.2.1">
                <p id="section-toc.1-1.12.2.1.1"><a href="#section-12.1" class="auto internal xref">12.1</a>.  <a href="#name-normative-references" class="internal xref">Normative References</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.12.2.2">
                <p id="section-toc.1-1.12.2.2.1"><a href="#section-12.2" class="auto internal xref">12.2</a>.  <a href="#name-informative-references" class="internal xref">Informative References</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.13">
            <p id="section-toc.1-1.13.1"><a href="#appendix-A" class="auto internal xref"></a><a href="#name-authors-addresses" class="internal xref">Authors' Addresses</a></p>
</li>
        </ul>
</nav>
</section>
</div>
<div id="introduction">
<section id="section-1">
      <h2 id="name-introduction">
<a href="#section-1" class="section-number selfRef">1. </a><a href="#name-introduction" class="section-name selfRef">Introduction</a>
      </h2>
<p id="section-1-1">This document specifies the Anonymous Rate-Limited Credential (ARC) protocol,
a specialization of keyed-verification anonymous credentials with support for
rate limiting.<a href="#section-1-1" class="pilcrow">¶</a></p>
<p id="section-1-2">ARC is privately verifiable (keyed-verification), yet differs from similar token-based
protocols in that each credential can be presented multiple times without violating
unlinkability of different presentations. Servers issue credentials to clients that
are cryptographically bound to client secrets and some public information.
Afterwards, clients can present this credential to the server up to some fixed
number of times, where each presentation provides proof that it was derived
from a valid (previously issued) credential and bound to some public information.
Each presentation is pairwise unlinkable, meaning the server cannot link any two
presentations to the same client credential, nor can the server link a presentation
to the preceding credential issuance flow. Notably, the maximum number of
presentations from a credential is fixed by the application.<a href="#section-1-2" class="pilcrow">¶</a></p>
<p id="section-1-3">ARC is useful in settings where applications require a fixed number of zero-knowledge
proofs about client secrets that can also be cryptographically bound to some public
information. This capability lets servers use credentials in applications that need
throttled or rate-limited access from anonymous clients.<a href="#section-1-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="conventions-and-definitions">
<section id="section-2">
      <h2 id="name-conventions-and-definitions">
<a href="#section-2" class="section-number selfRef">2. </a><a href="#name-conventions-and-definitions" class="section-name selfRef">Conventions and Definitions</a>
      </h2>
<div id="notation-and-terminology">
<section id="section-2.1">
        <h3 id="name-notation-and-terminology">
<a href="#section-2.1" class="section-number selfRef">2.1. </a><a href="#name-notation-and-terminology" class="section-name selfRef">Notation and Terminology</a>
        </h3>
<p id="section-2.1-1">The following functions and notation are used throughout the document.<a href="#section-2.1-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-2.1-2.1">
            <p id="section-2.1-2.1.1">concat(x0, ..., xN): Concatenation of byte strings. For example,
concat(0x01, 0x0203, 0x040506) = 0x010203040506.<a href="#section-2.1-2.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-2.1-2.2">
            <p id="section-2.1-2.2.1">bytes_to_int and int_to_bytes: Convert a byte string to and from a non-negative integer.
bytes_to_int and int_to_bytes are implemented as OS2IP and I2OSP as described in
<span>[<a href="#RFC8017" class="cite xref">RFC8017</a>]</span>, respectively. Note that these functions operate on byte strings
in big-endian byte order.<a href="#section-2.1-2.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-2.1-2.3">
            <p id="section-2.1-2.3.1">random_integer_uniform(M, N): Generate a random, uniformly distributed integer R
between M inclusive and N exclusive, i.e., M &lt;= R &lt; N.<a href="#section-2.1-2.3.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-2.1-2.4">
            <p id="section-2.1-2.4.1">random_integer_uniform_excluding_set(M, N, S): Generate a random, uniformly
distributed integer R between M inclusive and N exclusive, i.e., M &lt;= R &lt; N,
such that R does not exist in the set of integers S.<a href="#section-2.1-2.4.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-2.1-3">All algorithms and procedures described in this document are laid out
in a Python-like pseudocode. Each function takes a set of inputs and parameters
and produces a set of output values. Parameters become constant values once the
protocol variant and the ciphersuite are fixed.<a href="#section-2.1-3" class="pilcrow">¶</a></p>
<p id="section-2.1-4">The notation <code>T U[N]</code> refers to an array called U containing N items of type
T. The type <code>opaque</code> means one single byte of uninterpreted data. Items of
the array are zero-indexed and referred as <code>U[j]</code> such that 0 &lt;= j &lt; N.
The notation <code>{T}</code> refers to a set consisting of elements of type <code>T</code>.
For any object <code>x</code>, we write <code>len(x)</code> to denote its length in bytes.<a href="#section-2.1-4" class="pilcrow">¶</a></p>
<p id="section-2.1-5">String values such as "CredentialRequest", "CredentialResponse", "Presentation", and "Tag"
are ASCII string literals.<a href="#section-2.1-5" class="pilcrow">¶</a></p>
<p id="section-2.1-6">The following terms are used throughout this document.<a href="#section-2.1-6" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-2.1-7.1">
            <p id="section-2.1-7.1.1">Client: Protocol initiator. Creates a credential request, and uses the
corresponding server response to make a credential. The client can
make multiple presentations of this credential.<a href="#section-2.1-7.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-2.1-7.2">
            <p id="section-2.1-7.2.1">Server: Computes a response to a credential request, with its
server private keys. Later the server can verify the client's presentations
with its private keys. Learns nothing about the client's secret attributes,
and cannot link a client's request/response and presentation steps.<a href="#section-2.1-7.2.1" class="pilcrow">¶</a></p>
</li>
        </ul>
</section>
</div>
</section>
</div>
<div id="preliminaries">
<section id="section-3">
      <h2 id="name-preliminaries">
<a href="#section-3" class="section-number selfRef">3. </a><a href="#name-preliminaries" class="section-name selfRef">Preliminaries</a>
      </h2>
<p id="section-3-1">The construction in this document has one primary dependency:<a href="#section-3-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3-2.1">
          <p id="section-3-2.1.1"><code>Group</code>: A prime-order group implementing the API described below in <a href="#pog" class="auto internal xref">Section 3.1</a>.
See <a href="#ciphersuites" class="auto internal xref">Section 6</a> for specific instances of groups.<a href="#section-3-2.1.1" class="pilcrow">¶</a></p>
</li>
      </ul>
<div id="pog">
<section id="section-3.1">
        <h3 id="name-prime-order-group">
<a href="#section-3.1" class="section-number selfRef">3.1. </a><a href="#name-prime-order-group" class="section-name selfRef">Prime-Order Group</a>
        </h3>
<p id="section-3.1-1">In this document, we assume the construction of an additive, prime-order
group <code>Group</code> for performing all mathematical operations. In prime-order groups,
any element (other than the identity) can generate the other elements of the
group. Usually, one element is fixed and defined as the group generator.
In the ARC setting, there are two fixed generator elements (generatorG, generatorH).
Such groups are uniquely determined by the choice of the prime <code>p</code> that defines the
order of the group. (There may, however, exist different representations
of the group for a single <code>p</code>. <a href="#ciphersuites" class="auto internal xref">Section 6</a> lists specific groups which
indicate both order and representation.)<a href="#section-3.1-1" class="pilcrow">¶</a></p>
<p id="section-3.1-2">The fundamental group operation is addition <code>+</code> with identity element
<code>I</code>. For any elements <code>A</code> and <code>B</code> of the group, <code>A + B = B + A</code> is
also a member of the group. Also, for any <code>A</code> in the group, there exists an element
<code>-A</code> such that <code>A + (-A) = (-A) + A = I</code>. Scalar multiplication by <code>r</code> is
equivalent to the repeated application of the group operation on an
element A with itself <code>r-1</code> times, this is denoted as <code>r*A = A + ... + A</code>.
For any element <code>A</code>, <code>p*A=I</code>. The case when the scalar multiplication is
performed on the group generator is denoted as <code>ScalarMultGen(r)</code>.
Given two elements A and B, the discrete logarithm problem is to find
an integer k such that B = k*A. Thus, k is the discrete logarithm of
B with respect to the base A.
The set of scalars corresponds to <code>GF(p)</code>, a prime field of order p, and are
represented as the set of integers defined by <code>{0, 1, ..., p-1}</code>.
This document uses types
<code>Element</code> and <code>Scalar</code> to denote elements of the group and its set of
scalars, respectively.<a href="#section-3.1-2" class="pilcrow">¶</a></p>
<p id="section-3.1-3">We now detail a number of member functions that can be invoked on a
prime-order group.<a href="#section-3.1-3" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.1-4.1">
            <p id="section-3.1-4.1.1">Order(): Outputs the order of the group (i.e. <code>p</code>).<a href="#section-3.1-4.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-3.1-4.2">
            <p id="section-3.1-4.2.1">Identity(): Outputs the identity element of the group (i.e. <code>I</code>).<a href="#section-3.1-4.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-3.1-4.3">
            <p id="section-3.1-4.3.1">Generator(): Outputs the fixed generator of the group.<a href="#section-3.1-4.3.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-3.1-4.4">
            <p id="section-3.1-4.4.1">HashToGroup(x, info): Deterministically maps
an array of bytes <code>x</code> with domain separation value <code>info</code> to an element of <code>Group</code>. The map must ensure that,
for any adversary receiving <code>R = HashToGroup(x, info)</code>, it is
computationally difficult to reverse the mapping.
Security properties of this function are described
in <span>[<a href="#I-D.irtf-cfrg-hash-to-curve" class="cite xref">I-D.irtf-cfrg-hash-to-curve</a>]</span>.<a href="#section-3.1-4.4.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-3.1-4.5">
            <p id="section-3.1-4.5.1">HashToScalar(x, info): Deterministically maps
an array of bytes <code>x</code> with domain separation value <code>info</code> to an element in GF(p).
Security properties of this function are described in <span>[<a href="#I-D.irtf-cfrg-hash-to-curve" class="cite xref">I-D.irtf-cfrg-hash-to-curve</a>], <a href="https://datatracker.ietf.org/doc/html/draft-irtf-cfrg-hash-to-curve-16#section-10.5" class="relref">Section 10.5</a></span>.<a href="#section-3.1-4.5.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-3.1-4.6">
            <p id="section-3.1-4.6.1">RandomScalar(): Chooses at random a non-zero element in GF(p).<a href="#section-3.1-4.6.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-3.1-4.7">
            <p id="section-3.1-4.7.1">ScalarInverse(s): Returns the inverse of input <code>Scalar</code> <code>s</code> on <code>GF(p)</code>.<a href="#section-3.1-4.7.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-3.1-4.8">
            <p id="section-3.1-4.8.1">SerializeElement(A): Maps an <code>Element</code> <code>A</code>
to a canonical byte array <code>buf</code> of fixed length <code>Ne</code>.<a href="#section-3.1-4.8.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-3.1-4.9">
            <p id="section-3.1-4.9.1">DeserializeElement(buf): Attempts to map a byte array <code>buf</code> to
an <code>Element</code> <code>A</code>, and fails if the input is not the valid canonical byte
representation of an element of the group. This function can raise a
DeserializeError if deserialization fails or <code>A</code> is the identity element of
the group; see <a href="#ciphersuites" class="auto internal xref">Section 6</a> for group-specific input validation steps.<a href="#section-3.1-4.9.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-3.1-4.10">
            <p id="section-3.1-4.10.1">SerializeScalar(s): Maps a <code>Scalar</code> <code>s</code> to a canonical
byte array <code>buf</code> of fixed length <code>Ns</code>.<a href="#section-3.1-4.10.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-3.1-4.11">
            <p id="section-3.1-4.11.1">DeserializeScalar(buf): Attempts to map a byte array <code>buf</code> to a <code>Scalar</code> <code>s</code>.
This function can raise a DeserializeError if deserialization fails; see
<a href="#ciphersuites" class="auto internal xref">Section 6</a> for group-specific input validation steps.<a href="#section-3.1-4.11.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-3.1-5">For each group, there exists two distinct generators, generatorG and
generatorH, generatorG = G.Generator() and generatorH = G.HashToGroup(G.SerializeElement(generatorG), "generatorH").
The group member functions GeneratorG() and GeneratorH() are shorthand
for returning generatorG and generatorH, respectively.<a href="#section-3.1-5" class="pilcrow">¶</a></p>
<p id="section-3.1-6"><a href="#ciphersuites" class="auto internal xref">Section 6</a> contains details for the implementation of this interface
for different prime-order groups instantiated over elliptic curves.<a href="#section-3.1-6" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="arc-protocol">
<section id="section-4">
      <h2 id="name-arc-protocol">
<a href="#section-4" class="section-number selfRef">4. </a><a href="#name-arc-protocol" class="section-name selfRef">ARC Protocol</a>
      </h2>
<p id="section-4-1">The ARC protocol is a two-party protocol run between client and server
consisting of three distinct phases:<a href="#section-4-1" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-4-2">
<li id="section-4-2.1">
          <p id="section-4-2.1.1">Key generation. In this phase, the server generates its private and public
keys to be used for the remaining phases. This phase is described in <a href="#setup" class="auto internal xref">Section 4.1</a>.<a href="#section-4-2.1.1" class="pilcrow">¶</a></p>
</li>
        <li id="section-4-2.2">
          <p id="section-4-2.2.1">Credential issuance. In this phase, the client and server interact to issue
the client a credential that is cryptographically bound to client secrets.
This phase is described in <a href="#issuance" class="auto internal xref">Section 4.2</a>.<a href="#section-4-2.2.1" class="pilcrow">¶</a></p>
</li>
        <li id="section-4-2.3">
          <p id="section-4-2.3.1">Presentation. In this phase, the client uses the credential to create a "presentation"
to the server, where the server learns nothing more than whether or not the
presentation is valid and corresponds to some previously issued credential,
without learning which credential it corresponds to. This phase is described
in <a href="#presentation" class="auto internal xref">Section 4.3</a>.<a href="#section-4-2.3.1" class="pilcrow">¶</a></p>
</li>
      </ol>
<p id="section-4-3">This protocol bears resemblance to anonymous token protocols, such as those built on
Blind RSA <span>[<a href="#BLIND-RSA" class="cite xref">BLIND-RSA</a>]</span> and Oblivious Pseudorandom Functions <span>[<a href="#OPRFS" class="cite xref">OPRFS</a>]</span>
with one critical distinction: unlike anonymous tokens, an anonymous credential can be
used multiple times to create unlinkable presentations (up to the fixed presentation
limit). This means that a single issuance invocation can drive multiple presentation
invocations, whereas with anonymous tokens, each presentation invocation requires
exactly one issuance invocation. As a result, credentials are generally longer lived
than tokens. Applications configure the credential presentation limit after the
credential is issued such that client and server agree on the limit during presentation.
Servers are responsible for ensuring this limit is not exceeded. Clients that exceed
the agreed-upon presentation limit break the unlinkability guarantees provided by
the protocol.<a href="#section-4-3" class="pilcrow">¶</a></p>
<p id="section-4-4">The rest of this section describes the three phases of the ARC protocol.<a href="#section-4-4" class="pilcrow">¶</a></p>
<div id="setup">
<section id="section-4.1">
        <h3 id="name-key-generation">
<a href="#section-4.1" class="section-number selfRef">4.1. </a><a href="#name-key-generation" class="section-name selfRef">Key Generation</a>
        </h3>
<p id="section-4.1-1">In the key generation phase, the server generates its private and public
keys, denoted ServerPrivateKey and ServerPublicKey, as follows.<a href="#section-4.1-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-4.1-2">
<pre>
Input: None
Output:
- ServerPrivateKey:
  - x0: Scalar
  - x1: Scalar
  - x2: Scalar
  - x0Blinding: Scalar
- ServerPublicKey:
  - X0: Element
  - X1: Element
  - X2: Element

Parameters
- Group G

def SetupServer():
  x0 = G.RandomScalar()
  x1 = G.RandomScalar()
  x2 = G.RandomScalar()
  x0Blinding = G.RandomScalar()
  X0 = x0 * G.GeneratorG() + x0Blinding * G.GeneratorH()
  X1 = x1 * G.GeneratorH()
  X2 = x2 * G.GeneratorH()
  return (ServerPrivateKey(x0, x1, x2, x0Blinding),
    ServerPublicKey(X0, X1, X2))
</pre><a href="#section-4.1-2" class="pilcrow">¶</a>
</div>
<p id="section-4.1-3">The server public key can be serialized as follows:<a href="#section-4.1-3" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-4.1-4">
<pre>
struct {
  uint8 X0[Ne]; // G.SerializeElement(X0)
  uint8 X1[Ne]; // G.SerializeElement(X1)
  uint8 X2[Ne]; // G.SerializeElement(X2)
} ServerPublicKey;
</pre><a href="#section-4.1-4" class="pilcrow">¶</a>
</div>
<p id="section-4.1-5">The length of this encoded response structure is <code>NserverPublicKey = 3*Ne</code>.<a href="#section-4.1-5" class="pilcrow">¶</a></p>
</section>
</div>
<div id="issuance">
<section id="section-4.2">
        <h3 id="name-issuance">
<a href="#section-4.2" class="section-number selfRef">4.2. </a><a href="#name-issuance" class="section-name selfRef">Issuance</a>
        </h3>
<p id="section-4.2-1">The purpose of the issuance phase is for the client and server to cooperatively compute a credential
that is cryptographically bound to the client's secrets. Clients do not choose these secrets;
they are computed by the protocol.<a href="#section-4.2-1" class="pilcrow">¶</a></p>
<p id="section-4.2-2">The issuance phase of the protocol requires clients to know the server public key a priori, as well as
an arbitrary, application-specific request context. It requires no other input. It consists of three
distinct steps:<a href="#section-4.2-2" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-4.2-3">
<li id="section-4.2-3.1">
            <p id="section-4.2-3.1.1">The client generates and sends a credential request to the server. This credential request contains a
proof that the request is valid with respect to the client's secrets and request context. See
<a href="#issuance-step1" class="auto internal xref">Section 4.2.1</a> for details about this step.<a href="#section-4.2-3.1.1" class="pilcrow">¶</a></p>
</li>
          <li id="section-4.2-3.2">
            <p id="section-4.2-3.2.1">The server validates the credential request. If valid, it computes a credential response with the server
private keys. The response includes a proof that the credential response is valid with respect to the
server keys. The server sends the response to the client. See <a href="#issuance-step2" class="auto internal xref">Section 4.2.2</a> for details about this
step.<a href="#section-4.2-3.2.1" class="pilcrow">¶</a></p>
</li>
          <li id="section-4.2-3.3">
            <p id="section-4.2-3.3.1">The client finalizes the credential by processing the server response. If valid, this step yields a
credential that can then be used in the presentation phase of the protocol. See <a href="#issuance-step3" class="auto internal xref">Section 4.2.3</a> for
details about this step.<a href="#section-4.2-3.3.1" class="pilcrow">¶</a></p>
</li>
        </ol>
<p id="section-4.2-4">Each of these steps is described in the following subsections.<a href="#section-4.2-4" class="pilcrow">¶</a></p>
<div id="issuance-step1">
<section id="section-4.2.1">
          <h4 id="name-credential-request">
<a href="#section-4.2.1" class="section-number selfRef">4.2.1. </a><a href="#name-credential-request" class="section-name selfRef">Credential Request</a>
          </h4>
<p id="section-4.2.1-1">Given a request context, the process for creating a credential request is as follows:<a href="#section-4.2.1-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-4.2.1-2">
<pre>
(clientSecrets, request) = CreateCredentialRequest(requestContext, rng)

Inputs:
- requestContext: Data, context for the credential request
- rng: a cryptographically secure random number generator, as defined
  in the Sigma Protocol spec {{SIGMA}}.

Outputs:
- request:
  - m1Enc: Element, first encrypted secret.
  - m2Enc: Element, second encrypted secret.
  - requestProof: String (ZKProof), a proof of correct generation of
    m1Enc and m2Enc.
- clientSecrets:
  - m1: Scalar, first secret.
  - m2: Scalar, second secret.
  - r1: Scalar, blinding factor for first secret.
  - r2: Scalar, blinding factor for second secret.

Parameters:
- G: Group
- generatorG: Element, equivalent to G.GeneratorG()
- generatorH: Element, equivalent to G.GeneratorH()

def CreateCredentialRequest(requestContext, rng):
  m1 = G.RandomScalar()
  m2 = G.HashToScalar(requestContext, "requestContext")
  r1 = G.RandomScalar()
  r2 = G.RandomScalar()
  m1Enc = m1 * generatorG + r1 * generatorH
  m2Enc = m2 * generatorG + r2 * generatorH
  requestProof = MakeCredentialRequestProof(m1, m2, r1, r2,
    m1Enc, m2Enc, rng)
  request = (m1Enc, m2Enc, requestProof)
  clientSecrets = (m1, m2, r1, r2)
  return (clientSecrets, request)
</pre><a href="#section-4.2.1-2" class="pilcrow">¶</a>
</div>
<p id="section-4.2.1-3">See <a href="#request-proof" class="auto internal xref">Section 5.1</a> for more details on the generation of the credential request proof.<a href="#section-4.2.1-3" class="pilcrow">¶</a></p>
<p id="section-4.2.1-4">The resulting request can be serialized as follows.<a href="#section-4.2.1-4" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-4.2.1-5">
<pre>
struct {
  uint8 m1Enc[Ne];
  uint8 m2Enc[Ne];
  uint8 requestProof[5*Ns];
} CredentialRequest;
</pre><a href="#section-4.2.1-5" class="pilcrow">¶</a>
</div>
<p id="section-4.2.1-6">The length of this encoded request structure is <code>Nrequest = 2*Ne + 5*Ns</code>.<a href="#section-4.2.1-6" class="pilcrow">¶</a></p>
</section>
</div>
<div id="issuance-step2">
<section id="section-4.2.2">
          <h4 id="name-credential-response">
<a href="#section-4.2.2" class="section-number selfRef">4.2.2. </a><a href="#name-credential-response" class="section-name selfRef">Credential Response</a>
          </h4>
<p id="section-4.2.2-1">Given a credential request and server public and private keys, the process
for creating a credential response is as follows.<a href="#section-4.2.2-1" class="pilcrow">¶</a></p>
<div class="breakable lang-pseudocode sourcecode" id="section-4.2.2-2">
<pre>
response = CreateCredentialResponse(serverPrivateKey,
  serverPublicKey, request, rng)

Inputs:
- serverPrivateKey:
  - x0: Scalar (private), server private key 0.
  - x1: Scalar (private), server private key 1.
  - x2: Scalar (private), server private key 2.
  - x0Blinding: Scalar (private), blinding value for x0.
- serverPublicKey:
  - X0: Element, server public key 0.
  - X1: Element, server public key 1.
  - X2: Element, server public key 2.
- request:
  - m1Enc: Element, first encrypted secret.
  - m2Enc: Element, second encrypted secret.
  - requestProof: String (ZKProof), a proof of correct generation
    of m1Enc and m2Enc.
- rng: a cryptographically secure random number generator, as defined
  in the Sigma Protocol spec {{SIGMA}}.

Outputs:
- U: Element, a randomized generator for the response, `b*G`.
- encUPrime: Element, encrypted UPrime.
- X0Aux: Element, auxiliary point for X0.
- X1Aux: Element, auxiliary point for X1.
- X2Aux: Element, auxiliary point for X2.
- HAux: Element, auxiliary point for generatorH.
- responseProof: String (ZKProof), a proof of correct generation of
  U, encUPrime, server public keys, and auxiliary points.

Parameters:
- G: Group
- generatorG: Element, equivalent to G.GeneratorG()
- generatorH: Element, equivalent to G.GeneratorH()

Exceptions:
- VerifyError, raised when response verification fails

def CreateCredentialResponse(serverPrivateKey, serverPublicKey, request, rng):
  if VerifyCredentialRequestProof(request) == false:
    raise VerifyError

  b = G.RandomScalar()
  U = b * generatorG
  encUPrime = b * (serverPublicKey.X0 +
        serverPrivateKey.x1 * request.m1Enc +
        serverPrivateKey.x2 * request.m2Enc)
  X0Aux = b * serverPrivateKey.x0Blinding * generatorH
  X1Aux = b * serverPublicKey.X1
  X2Aux = b * serverPublicKey.X2
  HAux = b * generatorH

  responseProof = MakeCredentialResponseProof(serverPrivateKey,
    serverPublicKey, request, b, U, encUPrime,
    X0Aux, X1Aux, X2Aux, HAux, rng)
  return (U, encUPrime, X0Aux, X1Aux, X2Aux, HAux, responseProof)
</pre><a href="#section-4.2.2-2" class="pilcrow">¶</a>
</div>
<p id="section-4.2.2-3">The resulting response can be serialized as follows. See <a href="#response-proof" class="auto internal xref">Section 5.2</a> for more details on the generation of the credential response proof.<a href="#section-4.2.2-3" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-4.2.2-4">
<pre>
struct {
  uint8 U[Ne];
  uint8 encUPrime[Ne];
  uint8 X0Aux[Ne];
  uint8 X1Aux[Ne];
  uint8 X2Aux[Ne];
  uint8 HAux[Ne];
  uint8 responseProof[7*Ns];
} CredentialResponse
</pre><a href="#section-4.2.2-4" class="pilcrow">¶</a>
</div>
<p id="section-4.2.2-5">The length of this encoded response structure is <code>Nresponse = 6*Ne + 8*Ns</code>.<a href="#section-4.2.2-5" class="pilcrow">¶</a></p>
</section>
</div>
<div id="issuance-step3">
<section id="section-4.2.3">
          <h4 id="name-finalize-credential">
<a href="#section-4.2.3" class="section-number selfRef">4.2.3. </a><a href="#name-finalize-credential" class="section-name selfRef">Finalize Credential</a>
          </h4>
<p id="section-4.2.3-1">Given a credential request and response, server public keys, and the client
secrets produced when creating a credential request, the process for
finalizing the issuance flow and creating a credential is as follows.<a href="#section-4.2.3-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-4.2.3-2">
<pre>
credential = FinalizeCredential(clientSecrets,
  serverPublicKey, request, response)

Inputs:
- clientSecrets:
  - m1: Scalar, first secret.
  - m2: Scalar, second secret.
  - r1: Scalar, blinding factor for first secret.
  - r2: Scalar, blinding factor for second secret.
- serverPublicKey: ServerPublicKey, shared with the client out-of-band
- request:
  - m1Enc: Element, first encrypted secret.
  - m2Enc: Element, second encrypted secret.
  - requestProof: String (ZKProof), a proof of correct generation
    of m1Enc and m2Enc.
- response:
  - U: Element, a randomized generator for the response. `b*G`.
  - encUPrime: Element, encrypted UPrime.
  - X0Aux: Element, auxiliary point for X0.
  - X1Aux: Element, auxiliary point for X1.
  - X2Aux: Element, auxiliary point for X2.
  - HAux: Element, auxiliary point for generatorH.
  - responseProof: String (ZKProof), a proof of correct generation of
    U, encUPrime, server public keys, and auxiliary points.

Outputs:
- credential:
  - m1: Scalar, client's first secret.
  - U: Element, a randomized generator for the response. `b*G`.
  - UPrime: Element, the MAC over the server's private keys and the
    client's secrets.
  - X1: Element, server public key 1.

Exceptions:
- VerifyError, raised when response verification fails

Parameters:
- G: Group
- generatorG: Element, equivalent to G.GeneratorG()
- generatorH: Element, equivalent to G.GeneratorH()

def FinalizeCredential(clientSecrets, serverPublicKey, request,
  response):
  if VerifyCredentialResponseProof(serverPublicKey, response,
    request) == false:
    raise VerifyError
  UPrime = response.encUPrime - response.X0Aux
    - clientSecrets.r1 * response.X1Aux
    - clientSecrets.r2 * response.X2Aux
  return (clientSecrets.m1, response.U, UPrime, serverPublicKey.X1)
</pre><a href="#section-4.2.3-2" class="pilcrow">¶</a>
</div>
</section>
</div>
</section>
</div>
<div id="presentation">
<section id="section-4.3">
        <h3 id="name-presentation">
<a href="#section-4.3" class="section-number selfRef">4.3. </a><a href="#name-presentation" class="section-name selfRef">Presentation</a>
        </h3>
<p id="section-4.3-1">The purpose of the presentation phase is for the client to create a "presentation" to the server
which can be verified using the server private key. This phase is non-interactive, i.e., there is
no state stored between client and server in order to produce and then verify a presentation.
Client and server agree upon a fixed limit of presentations in order to create and verify
presentations; presentations will not verify correctly if the client and server use different
limits.<a href="#section-4.3-1" class="pilcrow">¶</a></p>
<p id="section-4.3-2">This phase consists of three steps:<a href="#section-4.3-2" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-4.3-3">
<li id="section-4.3-3.1">
            <p id="section-4.3-3.1.1">The client creates a presentation state for a given presentation context and presentation limit.
This state is used to produce a fixed amount of presentations.<a href="#section-4.3-3.1.1" class="pilcrow">¶</a></p>
</li>
          <li id="section-4.3-3.2">
            <p id="section-4.3-3.2.1">The client creates a presentation from the presentation state and sends it to the server.
The presentation is cryptographically bound to the state's presentation context, and
contains proof that the presentation is valid with respect to the presentation context.
Moreover, the presentation contains proof that the nonce (an integer) associated with this
presentation is within the presentation limit. The nonce value used in each presentation
is hidden in a Pedersen commitment, ensuring servers cannot link presentations using the nonce.<a href="#section-4.3-3.2.1" class="pilcrow">¶</a></p>
</li>
          <li id="section-4.3-3.3">
            <p id="section-4.3-3.3.1">The server verifies the presentation with respect to the presentation context and presentation
limit.<a href="#section-4.3-3.3.1" class="pilcrow">¶</a></p>
</li>
        </ol>
<p id="section-4.3-4">Details for each of these steps are in the following subsections.<a href="#section-4.3-4" class="pilcrow">¶</a></p>
<div id="presentation-state">
<section id="section-4.3.1">
          <h4 id="name-presentation-state">
<a href="#section-4.3.1" class="section-number selfRef">4.3.1. </a><a href="#name-presentation-state" class="section-name selfRef">Presentation State</a>
          </h4>
<p id="section-4.3.1-1">Presentation state is used to track the number of presentations for a given credential.
This state is important for ARC's unlinkability goals: reuse of state can break
unlinkability properties of credential presentations. State is initialized
with a credential, presentation context, and presentation limit. It is then mutated
after each presentation construction (as described in <a href="#presentation-construction" class="auto internal xref">Section 4.3.2</a>).<a href="#section-4.3.1-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-4.3.1-2">
<pre>
state = MakePresentationState(credential, presentationContext,
  presentationLimit)

Inputs:
- credential:
  - m1: Scalar, client's first secret.
  - U: Element, a randomized generator for the response `b*G`.
  - UPrime: Element, the MAC over the server's private keys and the
    client's secrets.
  - X1: Element, server public key 1.
- presentationContext: Data (public), used for presentation tag
  computation.
- presentationLimit: Integer, the fixed presentation limit.

Outputs:
- credential
- presentationContext: Data (public), used for presentation tag
  computation.
- nextNonce: Integer, the next nonce that can be used. This
  increments by 1 for each use.
- presentationLimit: Integer, the fixed presentation limit.

def MakePresentationState(credential, presentationContext,
  presentationLimit):
  return PresentationState(credential, presentationContext, 0,
    presentationLimit)
</pre><a href="#section-4.3.1-2" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="presentation-construction">
<section id="section-4.3.2">
          <h4 id="name-presentation-construction">
<a href="#section-4.3.2" class="section-number selfRef">4.3.2. </a><a href="#name-presentation-construction" class="section-name selfRef">Presentation Construction</a>
          </h4>
<p id="section-4.3.2-1">Creating a presentation requires a credential, presentation context, and presentation limit.
This process is necessarily stateful on the client since the number of times a credential
is used for a given presentation context cannot exceed the presentation limit; doing so
would break presentation unlinkability, as two presentations created with the same nonce
can be directly compared for equality (via the "tag"). As a result, the process for creating
a presentation accepts as input a presentation state and then outputs an updated presentation
state.<a href="#section-4.3.2-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-4.3.2-2">
<pre>
newState, nonce, presentation = Present(state, rng)

Inputs:
state: input PresentationState
  - credential
  - presentationContext: Data (public), used for presentation tag
    computation.
  - nextNonce: Integer, the next nonce that can be used. This
    increments by 1 for each use.
  - presentationLimit: Integer, the fixed presentation limit.
rng: a cryptographically secure random number generator, as defined
  in the Sigma Protocol spec {{SIGMA}}.

Outputs:
- newState: updated PresentationState
- nonce: Integer, the nonce associated with this presentation.
- presentation:
  - U: Element, re-randomized from the U in the response.
  - UPrimeCommit: Element, a public key to the issued UPrime.
  - m1Commit: Element, a public key to the client secret (m1).
  - tag: Element, the tag element used for enforcing the
    presentation limit.
  - nonceCommit: Element, a Pedersen commitment to the nonce.
  - presentationProof: ZKProof, a joint proof of correct generation
    of the presentation and that the committed nonce is in
    [0, presentationLimit).

Parameters:
- G: Group
- generatorG: Element, equivalent to G.GeneratorG()
- generatorH: Element, equivalent to G.GeneratorH()

Exceptions:
- LimitExceededError, raised when the presentation count meets or
  exceeds the presentation limit for the given presentation context

def Present(state, rng):
  if state.nextNonce &gt;= state.presentationLimit:
    raise LimitExceededError

  nonce = state.nextNonce
  # This step mutates the state by incrementing nextNonce by 1.
  state.nextNonce += 1

  a = G.RandomScalar()
  r = G.RandomScalar()
  z = G.RandomScalar()

  U = a * state.credential.U
  UPrime = a * state.credential.UPrime
  UPrimeCommit = UPrime + r * generatorG
  m1Commit = state.credential.m1 * U + z * generatorH

  # Create Pedersen commitment to the nonce
  nonceBlinding = G.RandomScalar()
  nonceCommit = G.Scalar(nonce) * generatorG + nonceBlinding * generatorH

  generatorT = G.HashToGroup(state.presentationContext, "Tag")
  tag = (state.credential.m1 + nonce)^(-1) * generatorT
  V = z * state.credential.X1 - r * generatorG

  # Generate presentation proof with integrated range proof
  presentationProof = MakePresentationProof(U, UPrimeCommit,
    m1Commit, tag, generatorT, state.credential, V, r, z, nonce,
    nonceBlinding, nonceCommit, state.presentationLimit, rng)

  presentation = (U, UPrimeCommit, m1Commit, tag, nonceCommit,
    presentationProof)

  return state, nonce, presentation
</pre><a href="#section-4.3.2-2" class="pilcrow">¶</a>
</div>
<p id="section-4.3.2-3">OPEN ISSUE: should the tag also fold in the presentation limit?<a href="#section-4.3.2-3" class="pilcrow">¶</a></p>
<p id="section-4.3.2-4">The resulting presentation can be serialized as follows. See <a href="#presentation-proof" class="auto internal xref">Section 5.3</a>
for more details on the generation of the presentation proof. The presentation proof
integrates the range proof as described in <a href="#range-proof" class="auto internal xref">Section 5.4</a>.<a href="#section-4.3.2-4" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-4.3.2-5">
<pre>
struct {
  uint8 U[Ne];
  uint8 UPrimeCommit[Ne];
  uint8 m1Commit[Ne];
  uint8 tag[Ne];
  uint8 nonceCommit[Ne];
  PresentationProof presentationProof;
} Presentation

struct {
  uint8 D[k][Ne]; // k = ceil(log2(presentationLimit))
  uint8 challenge[Ns];
  // Variable length based on presentation variables plus range proof variables
  uint8 responses[5 + 3 * k][Ns];
} PresentationProof
</pre><a href="#section-4.3.2-5" class="pilcrow">¶</a>
</div>
<p id="section-4.3.2-6">The length of the Presentation structure is <code>Npresentation = 5*Ne + Npresentationproof</code>.
<code>Npresentationproof = k * Ne + (6 + 3 * k) * Ns</code>, which includes the D commitments (k * Ne), the challenge (Ns), the response scalars for presentation variables (5 scalars: m1, z, -r, nonce, nonceBlinding), and range proof variables (3 * k scalars: <code>b[i]</code>, <code>s[i]</code>, <code>s2[i]</code> for each bit).
<code>k</code> is the number of bits it takes to represent the presentationLimit, i.e., <code>k = ceil(log2(presentationLimit))</code><a href="#section-4.3.2-6" class="pilcrow">¶</a></p>
</section>
</div>
<div id="presentation-verification">
<section id="section-4.3.3">
          <h4 id="name-presentation-verification">
<a href="#section-4.3.3" class="section-number selfRef">4.3.3. </a><a href="#name-presentation-verification" class="section-name selfRef">Presentation Verification</a>
          </h4>
<p id="section-4.3.3-1">The server processes the presentation by verifying the integrated presentation proof, which includes
verification of the range proof, against server-computed values. Note that the server does not receive
the raw nonce value, only the Pedersen commitment to it.<a href="#section-4.3.3-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-4.3.3-2">
<pre>
validity, tag = VerifyPresentation(serverPrivateKey,
  serverPublicKey, requestContext, presentationContext,
  presentation, presentationLimit)

Inputs:
- serverPrivateKey:
  - x0: Scalar (private), server private key 0.
  - x1: Scalar (private), server private key 1.
  - x2: Scalar (private), server private key 2.
  - x0Blinding: Scalar (private), blinding value for x0.
- serverPublicKey:
  - X0: Element, server public key 0.
  - X1: Element, server public key 1.
  - X2: Element, server public key 2.
- requestContext: Data, context for the credential request.
- presentationContext: Data (public), used for presentation tag
  computation.
- presentation:
  - U: Element, re-randomized from the U in the response.
  - UPrimeCommit: Element, a public key to the issued UPrime.
  - m1Commit: Element, a public key to the client secret (m1).
  - tag: Element, the tag element used for enforcing the
    presentation limit.
  - nonceCommit: Element, a Pedersen commitment to the nonce.
  - presentationProof: ZKProof, a joint proof of correct generation
    of the presentation and that the committed nonce is in
    [0, presentationLimit).
- presentationLimit: Integer, the fixed presentation limit.

Outputs:
- validity: Boolean, True if the presentation is valid,
  False otherwise.
- tag: Bytes, the value of the presentation tag used for rate
  limiting.

Parameters:
- G: Group
- generatorG: Element, equivalent to G.GeneratorG()
- generatorH: Element, equivalent to G.GeneratorH()

def VerifyPresentation(serverPrivateKey, serverPublicKey,
  requestContext, presentationContext, presentation,
  presentationLimit):

  # The presentation proof verifies the relationship between the tag,
  # m1, and the committed nonce using zero-knowledge techniques,
  # without learning the value of the nonce. It also includes
  # verification that the committed nonce is in
  # [0, presentationLimit).

  validity = VerifyPresentationProof(serverPrivateKey,
    serverPublicKey, requestContext, presentationContext,
    presentation, presentationLimit)

  return validity, presentation.tag
</pre><a href="#section-4.3.3-2" class="pilcrow">¶</a>
</div>
<p id="section-4.3.3-3">Implementation-specific steps: the server must perform a check that the tag (presentation.tag) has
not previously been seen, to prevent double spending. It then stores the tag for use in future double
spending checks. To reduce the overhead of performing double spend checks, the server can store and
look up the tags corresponding to the associated requestContext and presentationContext values.<a href="#section-4.3.3-3" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
</section>
</div>
<div id="zero-knowledge-proofs">
<section id="section-5">
      <h2 id="name-zero-knowledge-proofs">
<a href="#section-5" class="section-number selfRef">5. </a><a href="#name-zero-knowledge-proofs" class="section-name selfRef">Zero-Knowledge Proofs</a>
      </h2>
<p id="section-5-1">This section uses the Interactive Sigma Protocol <span>[<a href="#SIGMA" class="cite xref">SIGMA</a>]</span> to create zero-knowledge proofs of knowledge for various ARC operations, and the Fiat-Shamir Transform <span>[<a href="#FIAT-SHAMIR" class="cite xref">FIAT-SHAMIR</a>]</span> to make those proofs non-interactive.<a href="#section-5-1" class="pilcrow">¶</a></p>
<div id="request-proof">
<section id="section-5.1">
        <h3 id="name-credentialrequest-proof">
<a href="#section-5.1" class="section-number selfRef">5.1. </a><a href="#name-credentialrequest-proof" class="section-name selfRef">CredentialRequest Proof</a>
        </h3>
<p id="section-5.1-1">The request proof is a proof of knowledge of (m1, m2, r1, r2) used to generate the encrypted request. Statements to prove:<a href="#section-5.1-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-5.1-2">
<pre>
1. m1Enc = m1 * generatorG + r1 * generatorH
2. m2Enc = m2 * generatorG + r2 * generatorH
</pre><a href="#section-5.1-2" class="pilcrow">¶</a>
</div>
<div id="credentialrequest-proof-creation">
<section id="section-5.1.1">
          <h4 id="name-credentialrequest-proof-cre">
<a href="#section-5.1.1" class="section-number selfRef">5.1.1. </a><a href="#name-credentialrequest-proof-cre" class="section-name selfRef">CredentialRequest Proof Creation</a>
          </h4>
<div class="alignLeft art-text artwork" id="section-5.1.1-1">
<pre>
requestProof = MakeCredentialRequestProof(m1, m2, r1, r2, m1Enc,
  m2Enc, rng)

Inputs:
- m1: Scalar, first secret.
- m2: Scalar, second secret.
- r1: Scalar, blinding factor for first secret.
- r2: Scalar, blinding factor for second secret.
- m1Enc: Element, first encrypted secret.
- m2Enc: Element, second encrypted secret.
- rng: a cryptographically secure random number generator, as defined
  in the Sigma Protocol spec {{SIGMA}}.

Outputs:
- proof: String (ZKProof)

Parameters:
- G: Group
- generatorG: Element, equivalent to G.GeneratorG()
- generatorH: Element, equivalent to G.GeneratorH()
- contextString: public input

def MakeCredentialRequestProof(m1, m2, r1, r2, m1Enc, m2Enc, rng):
  statement = LinearRelation(G)
  [m1Var, m2Var, r1Var, r2Var] = statement.allocate_scalars(4)
  witness = [m1, m2, r1, r2]

  [genGVar, genHVar, m1EncVar, m2EncVar]
    = statement.allocate_elements(4)
  statement.set_elements([(genGVar, generatorG),
    (genHVar, generatorH), (m1EncVar, m1Enc), (m2EncVar, m2Enc)])

  # 1. m1Enc = m1 * generatorG + r1 * generatorH
  statement.append_equation(m1EncVar,
    [(m1Var, genGVar), (r1Var, genHVar)])

  # 2. m2Enc = m2 * generatorG + r2 * generatorH
  statement.append_equation(m2EncVar,
    [(m2Var, genGVar), (r2Var, genHVar)])

  session_id = contextString + "CredentialRequest"
  prover = NISchnorrProofShake128P256(session_id, statement)
  return prover.prove(witness, rng)
</pre><a href="#section-5.1.1-1" class="pilcrow">¶</a>
</div>
<p id="section-5.1.1-2">Where the request proof returned is a serialization of the following:
~~~
- challenge: Scalar, the challenge used in the proof of valid
  encryption.
- response0: Scalar, the response corresponding to m1.
- response1: Scalar, the response corresponding to m2.
- response2: Scalar, the response corresponding to r1.
- response3: Scalar, the response corresponding to r2.
~~~<a href="#section-5.1.1-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="credentialrequest-proof-verification">
<section id="section-5.1.2">
          <h4 id="name-credentialrequest-proof-ver">
<a href="#section-5.1.2" class="section-number selfRef">5.1.2. </a><a href="#name-credentialrequest-proof-ver" class="section-name selfRef">CredentialRequest Proof Verification</a>
          </h4>
<div class="alignLeft art-text artwork" id="section-5.1.2-1">
<pre>
validity = VerifyCredentialRequestProof(request)

Inputs:
- request:
  - m1Enc: Element, first encrypted secret.
  - m2Enc: Element, second encrypted secret.
  - requestProof: String (ZKProof), a proof of correct generation
    of m1Enc and m2Enc.

Outputs:
- validity: Boolean, True if the proof verifies correctly, False otherwise.

Parameters:
- G: group
- generatorG: Element, equivalent to G.GeneratorG()
- generatorH: Element, equivalent to G.GeneratorH()
- contextString: public input

def VerifyCredentialRequestProof(request):
  statement = LinearRelation(G)
  [m1Var, m2Var, r1Var, r2Var] = statement.allocate_scalars(4)

  [genGVar, genHVar, m1EncVar, m2EncVar]
    = statement.allocate_elements(4)
  statement.set_elements([(genGVar, generatorG),
    (genHVar, generatorH), (m1EncVar, m1Enc), (m2EncVar, m2Enc)])

  # 1. m1Enc = m1 * generatorG + r1 * generatorH
  statement.append_equation(m1EncVar,
    [(m1Var, genGVar), (r1Var, genHVar)])

  # 2. m2Enc = m2 * generatorG + r2 * generatorH
  statement.append_equation(m2EncVar,
    [(m2Var, genGVar), (r2Var, genHVar)])

  session_id = contextString + "CredentialRequest"
  verifier = NISchnorrProofShake128P256(session_id, statement)
  return verifier.verify(request.requestProof)
</pre><a href="#section-5.1.2-1" class="pilcrow">¶</a>
</div>
</section>
</div>
</section>
</div>
<div id="response-proof">
<section id="section-5.2">
        <h3 id="name-credentialresponse-proof">
<a href="#section-5.2" class="section-number selfRef">5.2. </a><a href="#name-credentialresponse-proof" class="section-name selfRef">CredentialResponse Proof</a>
        </h3>
<p id="section-5.2-1">The response proof is a proof of knowledge of (x0, x1, x2, x0Blinding, b) used in the server's CredentialResponse for the client's CredentialRequest. Statements to prove:<a href="#section-5.2-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-5.2-2">
<pre>
1. X0 = x0 * generatorG + x0Blinding * generatorH
2. X1 = x1 * generatorH
3. X2 = x2 * generatorH
4. X0Aux = b * x0Blinding * generatorH
  4a. HAux = b * generatorH
  4b: X0Aux = x0Blinding * HAux (= b * x0Blinding * generatorH)
5. X1Aux = b * x1 * generatorH
  5a. X1Aux = t1 * generatorH (t1 = b * x1)
  5b. X1Aux = b * X1 (X1 = x1 * generatorH)
6. X2Aux = b * x2 * generatorH
  6a. X2Aux = b * X2 (X2 = x2 * generatorH)
  6b. X2Aux = t2 * generatorH (t2 = b * x2)
7. U = b * generatorG
8. encUPrime = b * (X0 + x1 * Enc(m1) + x2 * Enc(m2))
</pre><a href="#section-5.2-2" class="pilcrow">¶</a>
</div>
<div id="credentialresponse-proof-creation">
<section id="section-5.2.1">
          <h4 id="name-credentialresponse-proof-cr">
<a href="#section-5.2.1" class="section-number selfRef">5.2.1. </a><a href="#name-credentialresponse-proof-cr" class="section-name selfRef">CredentialResponse Proof Creation</a>
          </h4>
<div class="alignLeft art-text artwork" id="section-5.2.1-1">
<pre>
responseProof = MakeCredentialResponseProof(serverPrivateKey,
  serverPublicKey, request, b, U, encUPrime,
  X0Aux, X1Aux, X2Aux, HAux, rng)

Inputs:
- serverPrivateKey:
  - x0: Scalar (private), server private key 0.
  - x1: Scalar (private), server private key 1.
  - x2: Scalar (private), server private key 2.
  - x0Blinding: Scalar (private), blinding value for x0.
- serverPublicKey:
  - X0: Element, server public key 0.
  - X1: Element, server public key 1.
  - X2: Element, server public key 2.
- request:
  - m1Enc: Element, first encrypted secret.
  - m2Enc: Element, second encrypted secret.
  - requestProof: String (ZKProof), a proof of correct generation
    of m1Enc and m2Enc.
- encUPrime: Element, encrypted UPrime.
- X0Aux: Element, auxiliary point for X0.
- X1Aux: Element, auxiliary point for X1.
- X2Aux: Element, auxiliary point for X2.
- HAux: Element, auxiliary point for generatorH.
- rng: a cryptographically secure random number generator, as defined
  in the Sigma Protocol spec {{SIGMA}}.

Outputs:
- proof: String (ZKProof)

Parameters:
- G: Group
- generatorG: Element, equivalent to G.GeneratorG()
- generatorH: Element, equivalent to G.GeneratorH()
- contextString: public input

def MakeCredentialResponseProof(serverPrivateKey, serverPublicKey,
  request, b, U, encUPrime, X0Aux, X1Aux, X2Aux, HAux, rng):
  statement = LinearRelation(G)
  [x0Var, x1Var, x2Var, x0BlindingVar, bVar, t1Var, t2Var]
    = statement.allocate_scalars(7)
  witness = [serverPrivateKey.x0, serverPrivateKey.x1,
    serverPrivateKey.x2, serverPrivateKey.x0Blinding, b,
    b*serverPrivateKey.x1, b*serverPrivateKey.x2]

  [genGVar, genHVar, m1EncVar, m2EncVar, UVar, encUPrimeVar, X0Var,
    X1Var, X2Var, X0AuxVar, X1AuxVar, X2AuxVar, HAuxVar]
    = statement.allocate_elements(13)
  statement.set_elements([(genGVar, generatorG),
    (genHVar, generatorH), (m1EncVar, request.m1Enc),
    (m2EncVar, request.m2Enc), (UVar, U), (encUPrimeVar, encUPrime),
    (X0Var, serverPublicKey.X0), (X1Var, serverPublicKey.X1),
    (X2Var, serverPublicKey.X2), (X0AuxVar, X0Aux),
    (X1AuxVar, X1Aux), (X2AuxVar, X2Aux), (HAuxVar, HAux)])

  # 1. X0 = x0 * generatorG + x0Blinding * generatorH
  statement.append_equation(X0Var, [(x0Var, genGVar),
    (x0BlindingVar, genHVar)])
  # 2. X1 = x1 * generatorH
  statement.append_equation(X1Var, [(x1Var, genHVar)])
  # 3. X2 = x2 * generatorH
  statement.append_equation(X2Var, [(x2Var, genHVar)])

  # 4. X0Aux = b * x0Blinding * generatorH
  # 4a. HAux = b * generatorH
  statement.append_equation(HAuxVar, [(bVar, genHVar)])
  # 4b: X0Aux = x0Blinding * HAux (= b * x0Blinding * generatorH)
  statement.append_equation(X0AuxVar, [(x0BlindingVar, HAuxVar)])

  # 5. X1Aux = b * x1 * generatorH
  # 5a. X1Aux = t1 * generatorH (t1 = b * x1)
  statement.append_equation(X1AuxVar, [(t1Var, genHVar)])
  # 5b. X1Aux = b * X1 (X1 = x1 * generatorH)
  statement.append_equation(X1AuxVar, [(bVar, X1Var)])

  # 6. X2Aux = b * x2 * generatorH
  # 6a. X2Aux = b * X2 (X2 = x2 * generatorH)
  pstatement.append_equation(X2AuxVar, [(bVar, X2Var)])
  # 6b. X2Aux = t2 * H (t2 = b * x2)
  statement.append_equation(X2AuxVar, [(t2Var, genHVar)])

  # 7. U = b * generatorG
  statement.append_equation(UVar, [(bVar, genGVar)])
  # 8. encUPrime = b * (X0 + x1 * Enc(m1) + x2 * Enc(m2))
  # simplified: encUPrime = b * X0 + t1 * m1Enc + t2 * m2Enc,
  # since t1 = b * x1 and t2 = b * x2
  statement.append_equation(encUPrimeVar, [(bVar, X0Var),
    (t1Var, m1EncVar), (t2Var, m2EncVar)])

  session_id = contextString + "CredentialResponse"
  prover = NISchnorrProofShake128P256(session_id, statement)
  return prover.prove(witness, rng)
</pre><a href="#section-5.2.1-1" class="pilcrow">¶</a>
</div>
<p id="section-5.2.1-2">Where the response proof returned is a serialization of the following:
~~~
- challenge: Scalar, the challenge used in the proof of valid
  response.
- response0: Scalar, the response corresponding to x0.
- response1: Scalar, the response corresponding to x1.
- response2: Scalar, the response corresponding to x2.
- response3: Scalar, the response corresponding to x0Blinding.
- response4: Scalar, the response corresponding to b.
- response5: Scalar, the response corresponding to t1.
- response6: Scalar, the response corresponding to t2.
~~~<a href="#section-5.2.1-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="credentialresponse-proof-verification">
<section id="section-5.2.2">
          <h4 id="name-credentialresponse-proof-ve">
<a href="#section-5.2.2" class="section-number selfRef">5.2.2. </a><a href="#name-credentialresponse-proof-ve" class="section-name selfRef">CredentialResponse Proof Verification</a>
          </h4>
<div class="alignLeft art-text artwork" id="section-5.2.2-1">
<pre>
validity = VerifyCredentialResponseProof(serverPublicKey, response,
  request)

Inputs:
- serverPublicKey:
  - X0: Element, server public key 0.
  - X1: Element, server public key 1.
  - X2: Element, server public key 2.
- response:
  - U: Element, a randomized generator for the response. `b*G`.
  - encUPrime: Element, encrypted UPrime.
  - X0Aux: Element, auxiliary point for X0.
  - X1Aux: Element, auxiliary point for X1.
  - X2Aux: Element, auxiliary point for X2.
  - HAux: Element, auxiliary point for generatorH.
  - responseProof: String (ZKProof), a proof of correct generation of
    U, encUPrime, server public keys, and auxiliary points.
- request:
  - m1Enc: Element, first encrypted secret.
  - m2Enc: Element, second encrypted secret.
  - requestProof: String (ZKProof), a proof of correct generation of
    m1Enc and m2Enc.

Outputs:
- validity: Boolean, True if the proof verifies correctly,
  False otherwise.

Parameters:
- G: Group
- generatorG: Element, equivalent to G.GeneratorG()
- generatorH: Element, equivalent to G.GeneratorH()

def VerifyCredentialResponseProof(serverPublicKey, response, request):
  statement = LinearRelation(G)
  [x0Var, x1Var, x2Var, x0BlindingVar, bVar, t1Var, t2Var]
    = statement.allocate_scalars(7)

  [genGVar, genHVar, m1EncVar, m2EncVar, UVar, encUPrimeVar, X0Var,
    X1Var, X2Var, X0AuxVar, X1AuxVar, X2AuxVar, HAuxVar]
    = statement.allocate_elements(13)
  statement.set_elements([(genGVar, generatorG),
    (genHVar, generatorH), (m1EncVar, request.m1Enc),
    (m2EncVar, request.m2Enc), (UVar, response.U),
    (encUPrimeVar, response.encUPrime), (X0Var, serverPublicKey.X0),
    (X1Var, serverPublicKey.X1), (X2Var, serverPublicKey.X2),
    (X0AuxVar, response.X0Aux), (X1AuxVar, response.X1Aux),
    (X2AuxVar, response.X2Aux), (HAuxVar, response.HAux)])

  # 1. X0 = x0 * generatorG + x0Blinding * generatorH
  statement.append_equation(X0Var, [(x0Var, genGVar),
    (x0BlindingVar, genHVar)])
  # 2. X1 = x1 * generatorH
  statement.append_equation(X1Var, [(x1Var, genHVar)])
  # 3. X2 = x2 * generatorH
  statement.append_equation(X2Var, [(x2Var, genHVar)])

  # 4. X0Aux = b * x0Blinding * generatorH
  # 4a. HAux = b * generatorH
  statement.append_equation(HAuxVar, [(bVar, genHVar)])
  # 4b: X0Aux = x0Blinding * HAux (= b * x0Blinding * generatorH)
  statement.append_equation(X0AuxVar, [(x0BlindingVar, HAuxVar)])

  # 5. X1Aux = b * x1 * generatorH
  # 5a. X1Aux = t1 * generatorH (t1 = b * x1)
  statement.append_equation(X1AuxVar, [(t1Var, genHVar)])
  # 5b. X1Aux = b * X1 (X1 = x1 * generatorH)
  statement.append_equation(X1AuxVar, [(bVar, X1Var)])

  # 6. X2Aux = b * x2 * generatorH
  # 6a. X2Aux = b * X2 (X2 = x2 * generatorH)
  pstatement.append_equation(X2AuxVar, [(bVar, X2Var)])
  # 6b. X2Aux = t2 * H (t2 = b * x2)
  statement.append_equation(X2AuxVar, [(t2Var, genHVar)])

  # 7. U = b * generatorG
  statement.append_equation(UVar, [(bVar, genGVar)])
  # 8. encUPrime = b * (X0 + x1 * Enc(m1) + x2 * Enc(m2))
  # simplified: encUPrime = b * X0 + t1 * m1Enc + t2 * m2Enc,
  # since t1 = b * x1 and t2 = b * x2
  statement.append_equation(encUPrimeVar, [(bVar, X0Var),
    (t1Var, m1EncVar), (t2Var, m2EncVar)])

  session_id = contextString + "CredentialResponse"
  verifier = NISchnorrProofShake128P256(session_id, statement)
  return verifier.verify(response.responseProof)
</pre><a href="#section-5.2.2-1" class="pilcrow">¶</a>
</div>
</section>
</div>
</section>
</div>
<div id="presentation-proof">
<section id="section-5.3">
        <h3 id="name-presentation-proof">
<a href="#section-5.3" class="section-number selfRef">5.3. </a><a href="#name-presentation-proof" class="section-name selfRef">Presentation Proof</a>
        </h3>
<p id="section-5.3-1">The presentation proof is a proof of knowledge of (m1, r, z, nonce, nonceBlinding) used in the presentation, as well as a proof that nonce is in the range [0, presentationLimit).<a href="#section-5.3-1" class="pilcrow">¶</a></p>
<p id="section-5.3-2">Statements to prove:<a href="#section-5.3-2" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-5.3-3">
<pre>
# The m1 commitment was correctly formed
1. m1Commit = m1 * U + z * generatorH
# Other presentation elements are consistent with the credential
2. V = z * X1 - r * generatorG
# The nonceCommit is a Pedersen commitment to nonce with blinding factor nonceBlinding
3. nonceCommit = nonce * generatorG + nonceBlinding * generatorH
# The tag was correctly computed using m1 and the nonce
4. T = m1 * tag + nonce * tag, where T = G.HashToGroup(presentationContext, "Tag")
# The nonce is in the range [0, presentationLimit)
5. constraints added by the range proof. See {#range-proof}.
</pre><a href="#section-5.3-3" class="pilcrow">¶</a>
</div>
<div id="presentation-proof-creation">
<section id="section-5.3.1">
          <h4 id="name-presentation-proof-creation">
<a href="#section-5.3.1" class="section-number selfRef">5.3.1. </a><a href="#name-presentation-proof-creation" class="section-name selfRef">Presentation Proof Creation</a>
          </h4>
<div class="alignLeft art-text artwork" id="section-5.3.1-1">
<pre>
presentationProof = MakePresentationProof(U, UPrimeCommit,
  m1Commit, tag, generatorT, credential, V, r, z, nonce,
  nonceBlinding, nonceCommit, presentationLimit, rng)

Inputs:
- U: Element, re-randomized from the U in the response.
- UPrimeCommit: Element, a public key to the MACGGM output UPrime.
- m1Commit: Element, a public key to the client secret (m1).
- tag: Element, the tag element used for enforcing the presentation
  limit.
- generatorT: Element, used for presentation tag computation.
- credential:
  - m1: Scalar, client's first secret.
  - U: Element, a randomized generator for the response. `b*G`.
  - UPrime: Element, the MAC over the server's private keys and the
    client's secrets.
  - X1: Element, server public key 1.
- V: Element, a proof helper element.
- r: Scalar (private), a randomly generated element used in
  presentation.
- z: Scalar (private), a randomly generated element used in
  presentation.
- nonce: Int, the nonce associated with the presentation.
- nonceBlinding: Scalar (private), the blinding factor for the nonce commitment.
- nonceCommit: Element, the Pedersen commitment to the nonce.
- presentationLimit: Integer, the fixed presentation limit.
- rng: a cryptographically secure random number generator, as defined
  in the Sigma Protocol spec {{SIGMA}}.

Outputs:
- presentationProof: ZKProof, a joint proof covering both
  presentation and range proof
  - D: [Element], array of commitments to the bit decomposition of
    the nonce
  - challenge: Scalar, the challenge used in the proof of valid
    presentation.
  - response: [Scalar], an array of scalars for all variables
    (presentation + range proof)

Parameters:
- G: Group
- generatorG: Element, equivalent to G.GeneratorG()
- generatorH: Element, equivalent to G.GeneratorH()
- contextString: public input

def MakePresentationProof(U, UPrimeCommit, m1Commit, tag, generatorT,
  credential, V, r, z, nonce, nonceBlinding, nonceCommit,
  presentationLimit, rng):
  statement = LinearRelation(G)
  [m1Var, zVar, rNegVar, nonceVar, nonceBlindingVar] = statement.allocate_scalars(5)

  [genGVar, genHVar, UVar, UPrimeCommitVar, m1CommitVar, VVar, X1Var,
    tagVar, genTVar, nonceCommitVar] = statement.allocate_elements(10)
  statement.set_elements([(genGVar, generatorG),
    (genHVar, generatorH), (UVar, U),
    (UPrimeCommitVar, UPrimeCommit), (m1CommitVar, m1Commit),
    (VVar, V), (X1Var, credential.X1), (tagVar, tag),
    (genTVar, generatorT), (nonceCommitVar, nonceCommit)])

  # 1. m1Commit = m1 * U + z * generatorH
  statement.append_equation(m1CommitVar,
    [(m1Var, UVar),(zVar, genHVar)])
  # 2. V = z * X1 - r * generatorG
  statement.append_equation(VVar, [(zVar, X1Var), (rNegVar, genGVar)])
  # 3. nonceCommit = nonce * generatorG + nonceBlinding * generatorH
  statement.append_equation(nonceCommitVar,
    [(nonceVar, genGVar), (nonceBlindingVar, genHVar)])
  # 4. T = m1 * tag + nonce * tag, where
  #    T = G.HashToGroup(presentationContext, "Tag")
  statement.append_equation(genTVar,
    [(m1Var, tagVar), (nonceVar, tagVar)])
  # 5. Add range proof constraints
  (statement, D) = MakeRangeProofHelper(statement, nonce,
    nonceBlinding, presentationLimit, genGVar, genHVar)

  # Build witness vector matching the scalar allocations
  witness = [credential.m1, z, -r, nonce, nonceBlinding]
  # Add range proof witnesses (b[i], s[i], s2[i] for each bit)
  # These are added by MakeRangeProofHelper

  session_id = contextString + "CredentialPresentation"
  prover = NISchnorrProofShake128P256(session_id, statement)
  return (prover.prove(witness, rng), D)
</pre><a href="#section-5.3.1-1" class="pilcrow">¶</a>
</div>
<p id="section-5.3.1-2">Where the presentation proof returned is a serialization of the following:
~~~
- challenge: Scalar, the challenge used in the proof of valid
  presentation.
- response0: Scalar, the response corresponding to m1.
- response1: Scalar, the response corresponding to z.
- response2: Scalar, the response corresponding to -r.
- response3: Scalar, the response corresponding to nonce.
~~~<a href="#section-5.3.1-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="presentation-proof-verification">
<section id="section-5.3.2">
          <h4 id="name-presentation-proof-verifica">
<a href="#section-5.3.2" class="section-number selfRef">5.3.2. </a><a href="#name-presentation-proof-verifica" class="section-name selfRef">Presentation Proof Verification</a>
          </h4>
<div class="alignLeft art-text artwork" id="section-5.3.2-1">
<pre>
validity = VerifyPresentationProof(serverPrivateKey,
  serverPublicKey, requestContext, presentationContext,
  presentation, presentationLimit)

Inputs:
- serverPrivateKey:
  - x0: Scalar (private), server private key 0.
  - x1: Scalar (private), server private key 1.
  - x2: Scalar (private), server private key 2.
  - x0Blinding: Scalar (private), blinding value for x0.
- serverPublicKey:
  - X0: Element, server public key 0.
  - X1: Element, server public key 1.
  - X2: Element, server public key 2.
- requestContext: Data, context for the credential request.
- presentationContext: Data (public), used for presentation tag
  computation.
- presentation:
  - U: Element, re-randomized from the U in the response.
  - UPrimeCommit: Element, a public key to the issued UPrime.
  - m1Commit: Element, a public key to the client secret (m1).
  - tag: Element, the tag element used for enforcing the
    presentation limit.
  - nonceCommit: Element, a Pedersen commitment to the nonce.
  - D: [Element], array of commitments to the bit decomposition of
    nonceCommit
  - presentationProof: ZKProof, a joint proof covering both
    presentation and range proof
    - challenge: Scalar, the challenge used in the proof of valid
      presentation.
    - response: [Scalar], an array of scalars for all variables
      (presentation + range proof)
- presentationLimit: Integer, the fixed presentation limit.

Outputs:
- validity: Boolean, True if the proof verifies correctly,
  False otherwise.

Parameters:
- G: Group
- generatorG: Element, equivalent to G.GeneratorG()
- generatorH: Element, equivalent to G.GeneratorH()
- contextString: public input

def VerifyPresentationProof(serverPrivateKey, serverPublicKey,
  requestContext, presentationContext, presentation,
  presentationLimit):

  m2 = G.HashToScalar(requestContext, "requestContext")
  V = serverPrivateKey.x0 * presentation.U + serverPrivateKey.x1 *
    presentation.m1Commit + serverPrivateKey.x2 * m2 *
    presentation.U - presentation.UPrimeCommit
  generatorT = G.HashToGroup(presentationContext, "Tag")

  statement = LinearRelation(G)
  [m1Var, zVar, rNegVar, nonceVar, nonceBlindingVar] =
    statement.allocate_scalars(5)

  [genGVar, genHVar, UVar, UPrimeCommitVar, m1CommitVar, VVar, X1Var,
    tagVar, genTVar, nonceCommitVar] = statement.allocate_elements(10)
  statement.set_elements([(genGVar, generatorG),
    (genHVar, generatorH), (UVar, presentation.U),
    (UPrimeCommitVar, presentation.UPrimeCommit),
    (m1CommitVar, presentation.m1Commit), (VVar, V),
    (X1Var, serverPublicKey.X1), (tagVar, presentation.tag),
    (genTVar, generatorT), (nonceCommitVar, presentation.nonceCommit)])

  # 1. m1Commit = m1 * U + z * generatorH
  statement.append_equation(m1CommitVar,
    [(m1Var, UVar),(zVar, genHVar)])
  # 2. V = z * X1 - r * generatorG
  statement.append_equation(VVar,
    [(zVar, X1Var), (rNegVar, genGVar)])
  # 3. nonceCommit = nonce * generatorG + nonceBlinding * generatorH
  statement.append_equation(nonceCommitVar,
    [(nonceVar, genGVar), (nonceBlindingVar, genHVar)])
  # 4. G.HashToGroup(presentationContext, "Tag")
  #    = m1 * tag + nonce * tag
  statement.append_equation(genTVar,
    [(m1Var, tagVar), (nonceVar, tagVar)])
  # 5. Add range proof constraints and verify the sum of the
  #    nonceCommit bit commitments
  (statement, sumValid) = VerifyRangeProofHelper(statement,
    presentation.proof.D, presentation.nonceCommit,
    presentationLimit, genGVar, genHVar)

  # Verify the joint proof
  session_id = contextString + "CredentialPresentation"
  verifier = NISchnorrProofShake128P256(session_id, statement)
  proofValid = sumValid and verifier.verify(
    presentation.presentationProof)
  return proofValid
</pre><a href="#section-5.3.2-1" class="pilcrow">¶</a>
</div>
</section>
</div>
</section>
</div>
<div id="range-proof">
<section id="section-5.4">
        <h3 id="name-range-proof-for-arbitrary-v">
<a href="#section-5.4" class="section-number selfRef">5.4. </a><a href="#name-range-proof-for-arbitrary-v" class="section-name selfRef">Range Proof for Arbitrary Values</a>
        </h3>
<p id="section-5.4-1">This section specifies a range proof to prove a secret value <code>nonce</code> lies
in an arbitrary interval <code>[0, presentationLimit)</code>. Before specifying the proof system, we first
give a brief overview of how it works. For simplicity, assume that <code>presentationLimit</code> is a
power of two, that is, <code>presentationLimit = 2^k</code> for some integer <code>k &gt; 0</code>.<a href="#section-5.4-1" class="pilcrow">¶</a></p>
<p id="section-5.4-2">To prove a value lies in <code>[0,(2^k)-1)</code>, we prove it has a valid <code>k</code>-bit representation.
This is proven by committing to the full value <code>nonce</code>, then all bits of the bit decomposition
<code>b</code> of the value <code>nonce</code>, and then proving each coefficient of the bit decomposition is
actually <code>0</code> or <code>1</code> and that the sum of the bits multiplied by their associated bases equals
the full value <code>nonce</code>.
This involves the following steps:<a href="#section-5.4-2" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-5.4-3">
<li id="section-5.4-3.1">
            <p id="section-5.4-3.1.1">Commit to the bits of <code>nonce</code>. That is, for each bit <code>b[i]</code> of the k-bit decomposition of <code>nonce</code>,
let <code>D[i] = b[i] * generatorG + s[i] * generatorH</code>, where <code>s[i]</code> is a blinding scalar.<a href="#section-5.4-3.1.1" class="pilcrow">¶</a></p>
</li>
          <li id="section-5.4-3.2">
            <p id="section-5.4-3.2.1">Prove that <code>b[i]</code> is in <code>{0,1}</code> by proving the algebraic relation <code>b[i] *
(b[i]-1) == 0</code> holds. This quadratic relation can be linearized by
adding an auxilary witness <code>s2[i]</code> and adding the linear relation
<code>D[i] = b[i] * D[i] + s2[i] * generatorH</code> to the equation system.
A valid witness <code>s2[i]</code> can only be computed by the prover if <code>b[i]</code> is in <code>{0,1}</code>,
and is computed as <code>s2[i] = (1 - b[i]) * s[i]</code>. Successfully computing a witness for
any other value, while satisfying the linear relation constraints, requires the prover
to break the discrete logarithm problem.<a href="#section-5.4-3.2.1" class="pilcrow">¶</a></p>
</li>
          <li id="section-5.4-3.3">
            <p id="section-5.4-3.3.1">In addition to verifying the proof of the above relation, the verifier checks that the sum of the bit
commitments is equal to the sum of the commitment to <code>nonce</code>:<a href="#section-5.4-3.3.1" class="pilcrow">¶</a></p>
</li>
        </ol>
<div class="alignLeft art-text artwork" id="section-5.4-4">
<pre>
nonceCommit = D[0] * 2^0 + D[1] * 2^1 + D[2] * 2^2 + ... + D[k-1] * 2^{k-1}
</pre><a href="#section-5.4-4" class="pilcrow">¶</a>
</div>
<p id="section-5.4-5">The third step is verified outside of the proof by adding the commitments
homomorphically.<a href="#section-5.4-5" class="pilcrow">¶</a></p>
<p id="section-5.4-6">To support the general case, where <code>presentationLimit</code> is not necessarily a power of two,
we extend the range proof for arbitrary ranges by decomposing the range
up to the second highest power of two and adding an additional, non-binary range that
covers the remaining range. This is detailed in <code>ComputeBases</code> below.<a href="#section-5.4-6" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-5.4-7">
<pre>
bases = ComputeBases(presentationLimit)

Inputs:
- presentationLimit: Integer, the maximum value of the range (exclusive).

Outputs:
- bases: an array of Scalar bases to represent elements, sorted in descending order. A base is
  either a power of two or a unique remainder that can be used to represent any integer
  in [0, presentationLimit).

def ComputeBases(presentationLimit):
  # compute bases to express the commitment as a linear combination of the bit decomposition
  remainder = presentationLimit
  bases = []
  k = ceil(log2(presentationLimit))
  # Generate all but the last power-of-two base.
  for i in range(k - 1):
      base = 2 ** i
      remainder -= base
      bases.append(base)
  bases.append(remainder - 1) # add non-binary base to close the gap

  # call sorted on array to ensure the additional base is in correct order
  return sorted(bases, reverse=True)
</pre><a href="#section-5.4-7" class="pilcrow">¶</a>
</div>
<p id="section-5.4-8">Note that by extending the range proof for arbitrary ranges, we are changing the bases used for decomposition and therefore introducing the potential for multiple valid decompositions of a value (the nonce). Implementations compliant with this specification MUST follow the canonical decomposition defined in <a href="#range-proof-creation" class="auto internal xref">Section 5.4.1</a>.<a href="#section-5.4-8" class="pilcrow">¶</a></p>
<div id="range-proof-creation">
<section id="section-5.4.1">
          <h4 id="name-range-proof-creation">
<a href="#section-5.4.1" class="section-number selfRef">5.4.1. </a><a href="#name-range-proof-creation" class="section-name selfRef">Range Proof Creation</a>
          </h4>
<p id="section-5.4.1-1">Using the bases from <code>ComputeBases</code>, the function <code>MakeRangeProofHelper</code>
represents the secret <code>nonce</code> as a linear combination of the bases, using the resulting
bit representation to generate the cryptographic commitments and witness values for the
range proof. This helper function is called from within <code>MakePresentationProof</code> to add
range proof constraints to the presentation proof statement.<a href="#section-5.4.1-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-5.4.1-2">
<pre>
(prover, D) = MakeRangeProofHelper(prover, nonce, nonceBlinding, presentationLimit,
                                   genGVar, genHVar)

Inputs:
- prover: Prover statement to which constraints will be added
- nonce: Integer, the nonce value to prove is in range
- nonceBlinding: Scalar, the blinding factor for the nonce commitment
- presentationLimit: Integer, the maximum value of the range (exclusive).
- genGVar: Integer, variable index for generator G
- genHVar: Integer, variable index for generator H

Outputs:
- prover: Modified prover statement with range proof constraints added
- D: [Element], array of commitments to the bit decomposition of nonceCommit

Parameters:
- G: Group
- generatorG: Element, equivalent to G.GeneratorG()
- generatorH: Element, equivalent to G.GeneratorH()

def MakeRangeProofHelper(statement, nonce, nonceBlinding, presentationLimit,
                         genGVar, genHVar):

  # Compute bit decomposition and commitments
  bases = ComputeBases(presentationLimit)

  # Compute bit decomposition of nonce
  b = []
  remainder = nonce
  # must run in constant-time (branching depends on secret value)
  for base in bases:
    bitValue = 1 if (remainder &gt;= base) else 0
    remainder -= bitValue * base
    b.append(G.Scalar(bitValue))

  # Compute commitments to bits
  D = []
  s = []
  s2 = []
  partial_sum = G.Scalar(0)
  for i in range(len(bases) - 1):
    s.append(G.RandomScalar())
    partial_sum += bases[i] * s[i]
    s2.append((G.Scalar(1) - b[i]) * s[i])
    D.append(b[i] * generatorG + s[i] * generatorH)
  # Blinding value for the last bit commitment is chosen strategically
  # so that all the bit commitments will sum up to nonceCommit.
  idx = len(bases) - 1
  s.append(G.ScalarInverse(bases[idx]) * (nonceBlinding - partial_sum))
  s2.append((G.Scalar(1) - b[idx]) * s[idx])
  D.append(b[idx] * generatorG + s[idx] * generatorH)

  # Allocate scalar variables (b, s, s2 for each bit)
  num_bits = len(b)
  vars_b = statement.allocate_scalars(num_bits)
  vars_s = statement.allocate_scalars(num_bits)
  vars_s2 = statement.allocate_scalars(num_bits)

  # Allocate and set element variables for bit commitments D
  vars_D = statement.allocate_elements(num_bits)
  statement.set_elements([(vars_D[i], D[i]) for i in range(num_bits)])

  # Add constraints proving each b[i] is in {0,1}
  for i in range(len(b)):
    # D[i] = b[i] * generatorG + s[i] * generatorH
    statement.append_equation(vars_D[i], [(vars_b[i], genGVar), (vars_s[i], genHVar)])
    # D[i] = b[i] * D[i] + s2[i] * generatorH (proves b[i] is in {0,1})
    statement.append_equation(vars_D[i], [(vars_b[i], vars_D[i]), (vars_s2[i], genHVar)])

  return (statement, D)
</pre><a href="#section-5.4.1-2" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="range-proof-verification">
<section id="section-5.4.2">
          <h4 id="name-range-proof-verification">
<a href="#section-5.4.2" class="section-number selfRef">5.4.2. </a><a href="#name-range-proof-verification" class="section-name selfRef">Range Proof Verification</a>
          </h4>
<div class="alignLeft art-text artwork" id="section-5.4.2-1">
<pre>
(verifier, sumValid) = VerifyRangeProofHelper(verifier, D, nonceCommit, presentationLimit,
                                              genGVar, genHVar)

Inputs:
- verifier: Verifier statement to which constraints will be added
- D: [Element], array of commitments to the bit decomposition of nonceCommit
- nonceCommit: Element, the Pedersen commitment to the nonce
- presentationLimit: Integer, the maximum value of the range (exclusive).
- genGVar: Integer, variable index for generator G
- genHVar: Integer, variable index for generator H

Outputs:
- verifier: Modified verifier statement with range proof constraints added
- validity: Boolean, True if sum(bases[i] * D[i]) == nonceCommit, False otherwise

Parameters:
- G: Group
- generatorG: Element, equivalent to G.GeneratorG()
- generatorH: Element, equivalent to G.GeneratorH()

def VerifyRangeProofHelper(statement, D, nonceCommit, presentationLimit,
                           genGVar, genHVar):

  bases = ComputeBases(presentationLimit)
  num_bits = len(bases)

  # Allocate scalar variables (b, s, s2 for each bit)
  vars_b = statement.allocate_scalars(num_bits)
  vars_s = statement.allocate_scalars(num_bits)
  vars_s2 = statement.allocate_scalars(num_bits)

  # Allocate and set element variables for bit commitments D
  vars_D = statement.allocate_elements(num_bits)
  statement.set_elements([(vars_D[i], D[i]) for i in range(num_bits)])

  # Add constraints proving each b[i] is in {0,1}
  for i in range(num_bits):
    # D[i] = b[i] * generatorG + s[i] * generatorH
    statement.append_equation(vars_D[i], [(vars_b[i], genGVar), (vars_s[i], genHVar)])
    # D[i] = b[i] * D[i] + s2[i] * generatorH
    statement.append_equation(vars_D[i], [(vars_b[i], vars_D[i]), (vars_s2[i], genHVar)])

  # Verify the sum check: nonceCommit == sum(bases[i] * D[i])
  # This is done explicitly by computing the sum homomorphically
  sum_D = G.Identity()
  for i in range(len(bases)):
    sum_D = sum_D + bases[i] * D[i]

  sumValid = (sum_D == nonceCommit)
  return (statement, sumValid)
</pre><a href="#section-5.4.2-1" class="pilcrow">¶</a>
</div>
</section>
</div>
</section>
</div>
</section>
</div>
<div id="ciphersuites">
<section id="section-6">
      <h2 id="name-ciphersuites">
<a href="#section-6" class="section-number selfRef">6. </a><a href="#name-ciphersuites" class="section-name selfRef">Ciphersuites</a>
      </h2>
<p id="section-6-1">A ciphersuite (also referred to as 'suite' in this document) for the protocol
wraps the functionality required for the protocol to take place. The
ciphersuite should be available to both the client and server, and agreement
on the specific instantiation is assumed throughout.<a href="#section-6-1" class="pilcrow">¶</a></p>
<p id="section-6-2">A ciphersuite contains an instantiation of the following functionality:<a href="#section-6-2" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-6-3.1">
          <p id="section-6-3.1.1"><code>Group</code>: A prime-order Group exposing the API detailed in <a href="#pog" class="auto internal xref">Section 3.1</a>, with the
generator element defined in the corresponding reference for each group. Each
group also specifies HashToGroup, HashToScalar, and serialization functionalities.
For HashToGroup, the domain separation tag (DST) is constructed in accordance
with the recommendations in <span>[<a href="#I-D.irtf-cfrg-hash-to-curve" class="cite xref">I-D.irtf-cfrg-hash-to-curve</a>], <a href="https://datatracker.ietf.org/doc/html/draft-irtf-cfrg-hash-to-curve-16#section-3.1" class="relref">Section 3.1</a></span>.
For HashToScalar, each group specifies an integer order that is used in
reducing integer values to a member of the corresponding scalar field.<a href="#section-6-3.1.1" class="pilcrow">¶</a></p>
</li>
      </ul>
<p id="section-6-4">This section includes an initial set of ciphersuites with supported groups.
It also includes implementation details for each ciphersuite, focusing on input validation.<a href="#section-6-4" class="pilcrow">¶</a></p>
<div id="arcp-256">
<section id="section-6.1">
        <h3 id="name-arcp-256">
<a href="#section-6.1" class="section-number selfRef">6.1. </a><a href="#name-arcp-256" class="section-name selfRef">ARC(P-256)</a>
        </h3>
<p id="section-6.1-1">This ciphersuite uses P-256 <span>[<a href="#NISTCurves" class="cite xref">NISTCurves</a>]</span> for the Group.
The value of the ciphersuite identifier is "P256". The value of
contextString is "ARCV1-P256".<a href="#section-6.1-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-6.1-2.1">
            <p id="section-6.1-2.1.1">Group: P-256 (secp256r1) <span>[<a href="#NISTCurves" class="cite xref">NISTCurves</a>]</span><a href="#section-6.1-2.1.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-6.1-2.1.2.1">
                <p id="section-6.1-2.1.2.1.1">Order(): Return 0xffffffff00000000ffffffffffffffffbce6faada7179e84f3b9cac2fc632551.<a href="#section-6.1-2.1.2.1.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-6.1-2.1.2.2">
                <p id="section-6.1-2.1.2.2.1">Identity(): As defined in <span>[<a href="#NISTCurves" class="cite xref">NISTCurves</a>]</span>.<a href="#section-6.1-2.1.2.2.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-6.1-2.1.2.3">
                <p id="section-6.1-2.1.2.3.1">Generator(): As defined in <span>[<a href="#NISTCurves" class="cite xref">NISTCurves</a>]</span>.<a href="#section-6.1-2.1.2.3.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-6.1-2.1.2.4">
                <p id="section-6.1-2.1.2.4.1">RandomScalar(): Implemented by returning a uniformly random Scalar in the range
[1, <code>G.Order()</code> - 1]. Refer to <a href="#random-scalar" class="auto internal xref">Section 6.2</a> for implementation guidance.<a href="#section-6.1-2.1.2.4.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-6.1-2.1.2.5">
                <p id="section-6.1-2.1.2.5.1">HashToGroup(x, info): Use hash_to_curve with suite P256_XMD:SHA-256_SSWU_RO_
<span>[<a href="#I-D.irtf-cfrg-hash-to-curve" class="cite xref">I-D.irtf-cfrg-hash-to-curve</a>]</span>, input <code>x</code>, and DST =
"HashToGroup-" || contextString || info.<a href="#section-6.1-2.1.2.5.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-6.1-2.1.2.6">
                <p id="section-6.1-2.1.2.6.1">HashToScalar(x, info): Use hash_to_field from <span>[<a href="#I-D.irtf-cfrg-hash-to-curve" class="cite xref">I-D.irtf-cfrg-hash-to-curve</a>]</span>
using L = 48, <code>expand_message_xmd</code> with SHA-256, input <code>x</code> and
DST = "HashToScalar-" || contextString || info, and
prime modulus equal to <code>Group.Order()</code>.<a href="#section-6.1-2.1.2.6.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-6.1-2.1.2.7">
                <p id="section-6.1-2.1.2.7.1">ScalarInverse(s): Returns the multiplicative inverse of input Scalar <code>s</code> mod <code>Group.Order()</code>.<a href="#section-6.1-2.1.2.7.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-6.1-2.1.2.8">
                <p id="section-6.1-2.1.2.8.1">SerializeElement(A): Implemented using the compressed Elliptic-Curve-Point-to-Octet-String
method according to <span>[<a href="#SEC1" class="cite xref">SEC1</a>]</span>; Ne = 33.<a href="#section-6.1-2.1.2.8.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-6.1-2.1.2.9">
                <p id="section-6.1-2.1.2.9.1">DeserializeElement(buf): Implemented by attempting to deserialize a 33-byte array to
a public key using the compressed Octet-String-to-Elliptic-Curve-Point method according to <span>[<a href="#SEC1" class="cite xref">SEC1</a>]</span>,
and then performs partial public-key validation as defined in section 5.6.2.3.4 of
<span>[<a href="#KEYAGREEMENT" class="cite xref">KEYAGREEMENT</a>]</span>. This includes checking that the
coordinates of the resulting point are in the correct range, that the point is on
the curve, and that the point is not the point at infinity. Additionally, this function
validates that the resulting element is not the group identity element.
If these checks fail, deserialization returns an InputValidationError error.<a href="#section-6.1-2.1.2.9.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-6.1-2.1.2.10">
                <p id="section-6.1-2.1.2.10.1">SerializeScalar(s): Implemented using the Field-Element-to-Octet-String conversion
according to <span>[<a href="#SEC1" class="cite xref">SEC1</a>]</span>; Ns = 32.<a href="#section-6.1-2.1.2.10.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-6.1-2.1.2.11">
                <p id="section-6.1-2.1.2.11.1">DeserializeScalar(buf): Implemented by attempting to deserialize a Scalar from a 32-byte
string using Octet-String-to-Field-Element from <span>[<a href="#SEC1" class="cite xref">SEC1</a>]</span>. This function can fail if the
input does not represent a Scalar in the range [1, <code>G.Order()</code> - 1].<a href="#section-6.1-2.1.2.11.1" class="pilcrow">¶</a></p>
</li>
            </ul>
</li>
        </ul>
</section>
</div>
<div id="random-scalar">
<section id="section-6.2">
        <h3 id="name-random-scalar-generation">
<a href="#section-6.2" class="section-number selfRef">6.2. </a><a href="#name-random-scalar-generation" class="section-name selfRef">Random Scalar Generation</a>
        </h3>
<p id="section-6.2-1">Two popular algorithms for generating a random integer uniformly distributed in
the range [1, G.Order() -1] are as follows:<a href="#section-6.2-1" class="pilcrow">¶</a></p>
<div id="rejection-sampling">
<section id="section-6.2.1">
          <h4 id="name-rejection-sampling">
<a href="#section-6.2.1" class="section-number selfRef">6.2.1. </a><a href="#name-rejection-sampling" class="section-name selfRef">Rejection Sampling</a>
          </h4>
<p id="section-6.2.1-1">Generate a random byte array with <code>Ns</code> bytes, and attempt to map to a Scalar
by calling <code>DeserializeScalar</code> in constant time. If it succeeds and is non-zero,
return the result. Otherwise, try again with another random byte array, until the
procedure succeeds. Failure to implement <code>DeserializeScalar</code> in constant time
can leak information about the underlying corresponding Scalar.<a href="#section-6.2.1-1" class="pilcrow">¶</a></p>
<p id="section-6.2.1-2">As an optimization, if the group order is very close to a power of
2, it is acceptable to omit the rejection test completely.  In
particular, if the group order is p, and there is an integer b
such that |p - 2<sup>b</sup>| is less than 2<sup>(b/2)</sup>, then
<code>RandomScalar</code> can simply return a uniformly random integer of at
most b bits.<a href="#section-6.2.1-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="random-number-generation-using-extra-random-bits">
<section id="section-6.2.2">
          <h4 id="name-random-number-generation-us">
<a href="#section-6.2.2" class="section-number selfRef">6.2.2. </a><a href="#name-random-number-generation-us" class="section-name selfRef">Random Number Generation Using Extra Random Bits</a>
          </h4>
<p id="section-6.2.2-1">Generate a random byte array with <code>L = ceil(((3 * ceil(log2(G.Order()))) / 2) / 8)</code>
bytes, and interpret it as an integer; reduce the integer modulo <code>G.Order()</code> and return the
result. See <span>[<a href="#I-D.irtf-cfrg-hash-to-curve" class="cite xref">I-D.irtf-cfrg-hash-to-curve</a>], <a href="https://datatracker.ietf.org/doc/html/draft-irtf-cfrg-hash-to-curve-16#section-5" class="relref">Section 5</a></span> for the underlying derivation of <code>L</code>.<a href="#section-6.2.2-1" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
</section>
</div>
<div id="security-considerations">
<section id="section-7">
      <h2 id="name-security-considerations">
<a href="#section-7" class="section-number selfRef">7. </a><a href="#name-security-considerations" class="section-name selfRef">Security Considerations</a>
      </h2>
<p id="section-7-1">For arguments about correctness, unforgeability, anonymity, and blind issuance of the ARC protocol, see the
"Formal Security Definitions for Keyed-Verification Anonymous Credentials" in <span>[<a href="#KVAC" class="cite xref">KVAC</a>]</span>.<a href="#section-7-1" class="pilcrow">¶</a></p>
<p id="section-7-2">This section elaborates on unlinkability properties for ARC and other implementation details
necessary for these properties to hold.<a href="#section-7-2" class="pilcrow">¶</a></p>
<div id="credential-request-unlinkability">
<section id="section-7.1">
        <h3 id="name-credential-request-unlinkab">
<a href="#section-7.1" class="section-number selfRef">7.1. </a><a href="#name-credential-request-unlinkab" class="section-name selfRef">Credential Request Unlinkability</a>
        </h3>
<p id="section-7.1-1">Client credential requests are constructed such that the server cannot distinguish between any two credential requests from the same client and two requests from different clients. We refer to this property as issuance unlinkability. This property is achieved by the way the credential requests are constructed. In particular, each credential request consists of two Pedersen commitments with fresh blinding factors, which are used to commit to a freshly generated client secret and request context. The resulting request is therefore statistically hiding, and independent from other requests from the same client. More details about this unlinkability property can be found in <span>[<a href="#KVAC" class="cite xref">KVAC</a>]</span> and <span>[<a href="#REVISITING_KVAC" class="cite xref">REVISITING_KVAC</a>]</span>.<a href="#section-7.1-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="credential-issuance-unlinkability">
<section id="section-7.2">
        <h3 id="name-credential-issuance-unlinka">
<a href="#section-7.2" class="section-number selfRef">7.2. </a><a href="#name-credential-issuance-unlinka" class="section-name selfRef">Credential Issuance Unlinkability</a>
        </h3>
<p id="section-7.2-1">The server commitment to <code>x0</code> is defined as <code>X0 = x0 * G.generatorG() + x0Blinding * G.GeneratorH()</code>, following the definitions in <span>[<a href="#KVAC" class="cite xref">KVAC</a>]</span>. This is computationally binding to the secret key <code>x0</code>. This means that unless the discrete log is broken, the credentials issued under one server commitment <code>X0, X1, ...</code> will all be issued under the same private keys <code>x0, x1, ...</code><a href="#section-7.2-1" class="pilcrow">¶</a></p>
<p id="section-7.2-2">However, an adversary breaking the discrete log (e.g., a quantum adversary) can find pairs <code>(x0, x0Blinding)</code> and <code>(x0', x0Blinding')</code> both committing to <code>X0</code> and use them to issue different credentials. This capability would let the adversary partitioning the client anonymity set by linking clients to the underlying secret used for credential issuance, i.e., <code>x0</code> or <code>x0'</code>. This requires an active attack and therefore is not an immediate concern.<a href="#section-7.2-2" class="pilcrow">¶</a></p>
<p id="section-7.2-3">Statistical anonymity is possible by committing to <code>x0</code> and <code>x0Blinding</code> separately, as in <span>[<a href="#REVISITING_KVAC" class="cite xref">REVISITING_KVAC</a>]</span>. However, the security of this construction requires additional analysis.<a href="#section-7.2-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="pres-unlinkability">
<section id="section-7.3">
        <h3 id="name-presentation-unlinkability">
<a href="#section-7.3" class="section-number selfRef">7.3. </a><a href="#name-presentation-unlinkability" class="section-name selfRef">Presentation Unlinkability</a>
        </h3>
<p id="section-7.3-1">Client credential presentations are constructed so that all presentations are indistinguishable, even if coming from the same user. We refer to this property as presentation unlinkability. This property is achieved by the way the credential presentations are constructed. The presentation elements <code>[U, UPrimeCommit, m1Commit]</code> are indistinguishable from all other presentations made from credentials issued with the same server keys, as detailed in <span>[<a href="#KVAC" class="cite xref">KVAC</a>]</span>.<a href="#section-7.3-1" class="pilcrow">¶</a></p>
<p id="section-7.3-2">The indistinguishability set for these presentation elements is <code>sum_{i=0}^c(p_i)</code>, where <code>c</code> is the number of credentials issued with the same server keys, and <code>p_i</code> is the number of presentations made for each of those credentials.<a href="#section-7.3-2" class="pilcrow">¶</a></p>
<p id="section-7.3-3">The presentation elements <code>[tag, nonceCommit, presentationContext, presentationProof, rangeProof]</code> are indistinguishable from all presentations made from credentials issued with the same server keys for that presentationContext. The nonce is never revealed to the server since it is hidden within a Pedersen commitment. The range proof ensures the committed nonce is within the valid range [0, presentationLimit) without revealing its value. This provides strong unlinkability properties: the server cannot link presentations based on nonce values, as the nonce commitment uses a fresh random blinding factor for each presentation.<a href="#section-7.3-3" class="pilcrow">¶</a></p>
<p id="section-7.3-4">The indistinguishability set for these presentation elements is <code>sum_{i=0}^c(p_i[presentationContext])</code>, where <code>c</code> is the number of credentials issued with the same server keys and <code>p_i[presentationContext]</code> is the number of presentations made for each of those credentials with the same presentationContext. Unlike protocols where nonces are revealed, presentations can not be linked by comparing nonce values, resulting in maximum unlinkability within the presentation context.<a href="#section-7.3-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="timing-leaks">
<section id="section-7.4">
        <h3 id="name-timing-leaks">
<a href="#section-7.4" class="section-number selfRef">7.4. </a><a href="#name-timing-leaks" class="section-name selfRef">Timing Leaks</a>
        </h3>
<p id="section-7.4-1">To ensure no information is leaked during protocol execution, all operations that use secret data MUST run in constant time. This includes all prime-order group operations and proof-specific operations that operate on secret data, including proof generation and verification.<a href="#section-7.4-1" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="alternatives-considered">
<section id="section-8">
      <h2 id="name-alternatives-considered">
<a href="#section-8" class="section-number selfRef">8. </a><a href="#name-alternatives-considered" class="section-name selfRef">Alternatives considered</a>
      </h2>
<p id="section-8-1">ARC uses the MACGGM algebraic MAC as its underlying primitive, as detailed in <span>[<a href="#KVAC" class="cite xref">KVAC</a>]</span> and <span>[<a href="#REVISITING_KVAC" class="cite xref">REVISITING_KVAC</a>]</span>. This offers the benefit of having a lower credential size than MACDDH, which is an alternative algebraic MAC detailed in <span>[<a href="#KVAC" class="cite xref">KVAC</a>]</span>.<a href="#section-8-1" class="pilcrow">¶</a></p>
<p id="section-8-2">The BBS anonymous credential scheme, as detailed in <span>[<a href="#BBS" class="cite xref">BBS</a>]</span> and its variants, is efficient and publicly verifiable, but requires pairings for verification. This is problematic for adoption because pairings are not supported as widely in software and hardware as non-pairing elliptic curves.<a href="#section-8-2" class="pilcrow">¶</a></p>
<p id="section-8-3">It is possible to construct a keyed-verification variant of BBS which doesn't use pairings, as discussed in <span>[<a href="#BBDT17" class="cite xref">BBDT17</a>]</span> and <span>[<a href="#REVISITING_KVAC" class="cite xref">REVISITING_KVAC</a>]</span>. However these keyed-verification BBS variants require more analysis, proofs of security properties, and review to be considered mature enough for safe deployment.<a href="#section-8-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="iana-considerations">
<section id="section-9">
      <h2 id="name-iana-considerations">
<a href="#section-9" class="section-number selfRef">9. </a><a href="#name-iana-considerations" class="section-name selfRef">IANA Considerations</a>
      </h2>
<p id="section-9-1">This document has no IANA actions.<a href="#section-9-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="test-vectors">
<section id="section-10">
      <h2 id="name-test-vectors">
<a href="#section-10" class="section-number selfRef">10. </a><a href="#name-test-vectors" class="section-name selfRef">Test Vectors</a>
      </h2>
<p id="section-10-1">This section contains test vectors for the ARC ciphersuites specified in this document.<a href="#section-10-1" class="pilcrow">¶</a></p>
<div id="arcv1-p256">
<section id="section-10.1">
        <h3 id="name-arcv1-p256">
<a href="#section-10.1" class="section-number selfRef">10.1. </a><a href="#name-arcv1-p256" class="section-name selfRef">ARCV1-P256</a>
        </h3>
<div class="alignLeft art-text artwork" id="section-10.1-1">
<pre>
// ServerKey
x0 = 2c5c7e44f47bfcc02fed25f34e91bccac5eb37b31bdedf5fefe6e6debd501c4
e
x1 = bb0a73e0e01ea4f83372ca02dcd3b9d9fa170d59175af05eef5287f9a25095a
a
x2 = b919384a5294031accf4b9cfdafcb8977e780f1dcb217d743e320405626f3da
4
xb = 1290f1e13fe09ff1ae9160ed32afe7ce80cbce8743f9df04158a56090e6fe4a
a
X0 = 0216fec6d3afbb6ae7a8aca2199b1003fcd7edd3fe0999a64d3495c7fd07e91
eed
X1 = 03ee043ba7c4ba897cbc9c0b45e7349b4c691828d60e28d117da0c25a343f0f
c07
X2 = 0253b17924aa247355b3e2adaef0aea62eaab2abd9138fadf8f7200c8015e4e
d8f

// CredentialRequest
request_context = 74657374207265717565737420636f6e74657874
m1 = 4edb211ba290fc576f99076319d591d2ac18bce3a83423454310e07e8f8a8d4
6
m2 = 911fb315257d9ae29d47ecb48c6fa27074dee6860a0489f8db6ac9a486be6a3
e
r1 = 212a8835f020bc580723c61ae156558bd3228796011ae35446510e6870fcb4a
1
r2 = b2a644d24febb7756a10740c7722fb152538cb381fbcee1686733c82a2e4ed8
d
m1_enc = 0397f0b9c70b77a91cca0d888349c14f1f9ae689c75f6534edd95560adb
71c797a
m2_enc = 035c4c894ae9c9b99c9c266dc1987873397f8bbdf6e70861c7a224b2e21
2a35efc
proof = 99eca1271bab1e0e6172e5cafd40adce6d379af9101aba95a8568071d9de
12718e9c66b174da8a03fd49dc64e6fc145faf8ae35963cbb054c5ad3a49367b4f8d
99878453cbb2b463493ece93a32259aef8e9d69034260525fb4944fd28792b2f6383
73c40aff5085e4f1011541ed6d724420291ce29727d5bbdf16b6a65fc96c443b7133
3b6695e50224572d33618a922ed09b930ea8e86068b9b66355855e4a

// CredentialResponse
b = 24e2575ae90f65ace28d69d413550334f42a72a07fdfa67b7cd3a26861e3f2a5
U = 03329f40ec982ad7e9a7fa987c07e328db3d482d2c589b12b2fba2081a5afdde
69
enc_U_prime = 03d693f1b3a72da5c421ce8e59168bc4758f2f87d51f19d8a54d16
87288398d0b5
X0_aux = 0392855352c21d93bd30c10e14ef86723a362252a5cf594ad29f0f9f46c
f92bc2b
X1_aux = 03407d7c2cc30930981c5f0f99db2fb59cbef587f8c90888ff4758365bb
13931c6
X2_aux = 0327d9c2613ed4377ebdfe776bbbbd67bb9c24448502d3b8c7047bed11c
47c5e19
H_aux = 027f3c5eac6b9d2c1a00be163d6c847f6c03939c6c15d386eb6909991490
968b86
proof = a802b937588e38034496642fb8bbf98e3cadda4aade4c6bc084cf142cf3e
5076e6fe3ad39c9d30b8665ae960a6746e7d6e4e758f317644607893981b6cd346bc
a75a46cb409b1ab0d883c9806b1adc9d48b4a0d9c8a2b56e5c94497a94c4bdcaaccc
c5133cf91aea9c17e892ba6621b44f3f0d006f510353dc2dcc9fa7b45836a89b7751
5ccf61902c6a2d03d47857c6758d79071eab35018544525a153057370259b29e88e1
eb060a07bfb50c9cd90683ea5f0b9e412c9c04abb18a59bb170770da24ddea5076d3
eda2a067ca8eb872853c2cd5b4fa4e1ffc2898e5ce5722d92ec4b589bb0586c431ca
9a6a1a4abca724085bc939201cb15378d5e31a3089f5

// Credential
m1 = 4edb211ba290fc576f99076319d591d2ac18bce3a83423454310e07e8f8a8d4
6
U = 03329f40ec982ad7e9a7fa987c07e328db3d482d2c589b12b2fba2081a5afdde
69
U_prime = 03bfdf77b756eb73971e81ceb285023373a52aee1d4bfdef1d27e95a7d
a02067f3
X1 = 03ee043ba7c4ba897cbc9c0b45e7349b4c691828d60e28d117da0c25a343f0f
c07

// Presentation1
presentation_context = 746573742070726573656e746174696f6e20636f6e746
57874
a = 45a69febb7bce43f0649ceff301fab1d35e815aed0712362fabda5adb6e08505
r = 145f8b55d18472effd080504d6e46b495af46e3ff7cafb948d9c9355597b91f4
z = 44bba2569aa107cafb6a4c53f0cf8e8921c2c5ae96b93ffc89eb348fa0fdaa80
U = 022145450d7e1af2e3d920f5b15d27a3bef0edd4d14494332a5f44cc5fa0fabb
ef
U_prime_commit = 02484f74d873da192d00f0d9121d678ce07a1e6065cd28172e2
83262f189e3a766
m1_commit = 02b80a1a627f8c8bfbef33945e4afeb8bc979167f78c1c0c629eb9c2
5829f4bdbf
nonce = 0x0
nonce_blinding = 694992897d6991967093efe47d62732dc712da8c0af00d9e788
816151f307bc2
nonce_commit = 03a0e71d6270fae25188479eae0712dd5ea0eb02618c790a47c3a
c01977509a23d
tag = 0223f0acb74d546fa30e70627583a0f5ad19cb07086b6b2a5a1ff3a3e9e1e4
99a4
D_0 = 03a0e71d6270fae25188479eae0712dd5ea0eb02618c790a47c3ac01977509
a23d
proof = 03a0e71d6270fae25188479eae0712dd5ea0eb02618c790a47c3ac019775
09a23dec447f1e474ebd76930be11c4a6f62ef074f67fae2ce4c4c2348f457bd8844
4f877b0493c15e8d56d5b747d7a451e57c19903325f4a86db075cc13594b4b70a86a
aacd48025ac6fade224bcd096dd8c9464a67c7de3a8f1da105af6e8784f28b5c8d51
9934ed515483b69404e09ff73cea25c0b3a4896f5724af888cdbeff51b7f93dca199
6a2a4b44e5fda8aa6976da17a7a4e88ddb4404cece667ec41d57b1cfcbe7ca754db1
0623b041d4b6952ad04fa2695e337d659134a5feab55d2e483ae585ae3c74f9e402f
5a8dd569d33651b91e69bb588686e3ca2cf5e3396a520567e713a1bfa13ee21f2cda
d70f57edd9161ecbf273d417fc423c107d0ee48e683a84abdba8c420ca73df1714c2
7181ffe78ebde87f80343567d078740eb3a34f

// Presentation2
presentation_context = 746573742070726573656e746174696f6e20636f6e746
57874
a = a6782c88f22610270a5183041ace903d71a47bd960a71706d457aeb390543543
r = 516fa9a221ec54cd608bc42cd20e826fdbe028ba2733a27f739ca0931058dbfe
z = 38cdd974f39d66214bf2ce2359114cf5bdd3a88091709c16caec87e2053cd90c
U = 02fce0aa7f6a75d71d8b1a9277e7c0309be594540226d65466698e89f4f83621
78
U_prime_commit = 03c4f7268e18df54b8768c57972334d53d81d65e363380899aa
ac5c888886a7da2
m1_commit = 031901862a9deea1644b4497b7df4f4554754ad8dc1edda89d1d8b7a
b7b8a09250
nonce = 0x1
nonce_blinding = a6892d3897e7c2cc438e6f2f70f199c236edb00892a40e954d5
079080c55dc2b
nonce_commit = 02c3edfd1e2aeed71af3286b0d638d24edbbb79e99f21a8f1bbb1
5e8d252833833
tag = 0377c213e0b6f73676ac29b20e5726c1aefe6aa52d0ded96ba2802c7715e1b
e3a1
D_0 = 02c3edfd1e2aeed71af3286b0d638d24edbbb79e99f21a8f1bbb15e8d25283
3833
proof = 02c3edfd1e2aeed71af3286b0d638d24edbbb79e99f21a8f1bbb15e8d252
833833efaab7828d4477dcad6eaf5017aa36b66eaaa1348dbe64f3eed00747d00e97
bb52a083c9d391dcdc02233e5cae76ac38b996cfa202901956bbe26d617546d09876
42b486415c005179d70cf04311287beb2811d1390b0d72beda2a43cd9c6f8552d5ae
8152d01ec78f9d5b116a88a4bca583bcfe75df9fce5fab30cb3aeddc8eb75e4f5e85
e20b27f688a43ab72be40be6e044791f3302ee81ebd9c0fae8db62c8232754100fbf
5fe33e19503f14e311feb2f4f8adfa6e8045a03e6b3d6586bc5ce02da50c34d9db1e
5aef3bcb2ab29c82bd98a359132fbf2fa237f15f8bf00b4f390c14c32acaa1b87977
24fb03484e6c807324eecb95a6d714b730d6feafc02490b520854c30324d218e713e
b8efc5b2b590aaadea6f07a6fa333afd6e3a5b

</pre><a href="#section-10.1-1" class="pilcrow">¶</a>
</div>
</section>
</div>
</section>
</div>
<div id="acknowledgments">
<section id="section-11">
      <h2 id="name-acknowledgments">
<a href="#section-11" class="section-number selfRef">11. </a><a href="#name-acknowledgments" class="section-name selfRef">Acknowledgments</a>
      </h2>
<p id="section-11-1">The authors would like to acknowledge helpful conversations with Tommy Pauly about rate limiting and Privacy Pass integration, as well as Lena Heimberger for specifying the range proof.<a href="#section-11-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="sec-combined-references">
<section id="section-12">
      <h2 id="name-references">
<a href="#section-12" class="section-number selfRef">12. </a><a href="#name-references" class="section-name selfRef">References</a>
      </h2>
<div id="sec-normative-references">
<section id="section-12.1">
        <h3 id="name-normative-references">
<a href="#section-12.1" class="section-number selfRef">12.1. </a><a href="#name-normative-references" class="section-name selfRef">Normative References</a>
        </h3>
<dl class="references">
<dt id="FIAT-SHAMIR">[FIAT-SHAMIR]</dt>
        <dd>
<span class="refAuthor">Orrù, M.</span>, <span class="refTitle">"Fiat-Shamir Transformation"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-irtf-cfrg-fiat-shamir-01</span>, <time datetime="2025-10-20" class="refDate">20 October 2025</time>, <span>&lt;<a href="https://datatracker.ietf.org/doc/html/draft-irtf-cfrg-fiat-shamir-01">https://datatracker.ietf.org/doc/html/draft-irtf-cfrg-fiat-shamir-01</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.irtf-cfrg-hash-to-curve">[I-D.irtf-cfrg-hash-to-curve]</dt>
        <dd>
<span class="refAuthor">Faz-Hernandez, A. F.</span>, <span class="refAuthor">Scott, S.</span>, <span class="refAuthor">Sullivan, N.</span>, <span class="refAuthor">Wahby, R. S.</span>, and <span class="refAuthor">C. A. Wood</span>, <span class="refTitle">"Hashing to Elliptic Curves"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-irtf-cfrg-hash-to-curve-16</span>, <time datetime="2022-06-15" class="refDate">15 June 2022</time>, <span>&lt;<a href="https://datatracker.ietf.org/doc/html/draft-irtf-cfrg-hash-to-curve-16">https://datatracker.ietf.org/doc/html/draft-irtf-cfrg-hash-to-curve-16</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="KEYAGREEMENT">[KEYAGREEMENT]</dt>
        <dd>
<span class="refAuthor">Barker, E.</span>, <span class="refAuthor">Chen, L.</span>, <span class="refAuthor">Roginsky, A.</span>, <span class="refAuthor">Vassilev, A.</span>, and <span class="refAuthor">R. Davis</span>, <span class="refTitle">"Recommendation for pair-wise key-establishment schemes using discrete logarithm cryptography"</span>, <span class="refContent">National Institute of Standards and Technology</span>, <span class="seriesInfo">DOI 10.6028/nist.sp.800-56ar3</span>, <time datetime="2018-04" class="refDate">April 2018</time>, <span>&lt;<a href="https://doi.org/10.6028/nist.sp.800-56ar3">https://doi.org/10.6028/nist.sp.800-56ar3</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8017">[RFC8017]</dt>
        <dd>
<span class="refAuthor">Moriarty, K., Ed.</span>, <span class="refAuthor">Kaliski, B.</span>, <span class="refAuthor">Jonsson, J.</span>, and <span class="refAuthor">A. Rusch</span>, <span class="refTitle">"PKCS #1: RSA Cryptography Specifications Version 2.2"</span>, <span class="seriesInfo">RFC 8017</span>, <span class="seriesInfo">DOI 10.17487/RFC8017</span>, <time datetime="2016-11" class="refDate">November 2016</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc8017">https://www.rfc-editor.org/rfc/rfc8017</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="SIGMA">[SIGMA]</dt>
      <dd>
<span class="refAuthor">Orrù, M.</span> and <span class="refAuthor">C. Yun</span>, <span class="refTitle">"Interactive Sigma Proofs"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-irtf-cfrg-sigma-protocols-01</span>, <time datetime="2025-10-20" class="refDate">20 October 2025</time>, <span>&lt;<a href="https://datatracker.ietf.org/doc/html/draft-irtf-cfrg-sigma-protocols-01">https://datatracker.ietf.org/doc/html/draft-irtf-cfrg-sigma-protocols-01</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
</div>
<div id="sec-informative-references">
<section id="section-12.2">
        <h3 id="name-informative-references">
<a href="#section-12.2" class="section-number selfRef">12.2. </a><a href="#name-informative-references" class="section-name selfRef">Informative References</a>
        </h3>
<dl class="references">
<dt id="BBDT17">[BBDT17]</dt>
        <dd>
<span class="refTitle">"Improved Algebraic MACs and Practical Keyed-Verification Anonymous Credentials"</span>, <span>n.d.</span>, <span>&lt;<a href="https://link.springer.com/chapter/10.1007/978-3-319-69453-5_20">https://link.springer.com/chapter/10.1007/978-3-319-69453-5_20</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="BBS">[BBS]</dt>
        <dd>
<span class="refTitle">"Short Group Signatures"</span>, <span>n.d.</span>, <span>&lt;<a href="https://eprint.iacr.org/2004/174">https://eprint.iacr.org/2004/174</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="BLIND-RSA">[BLIND-RSA]</dt>
        <dd>
<span class="refAuthor">Denis, F.</span>, <span class="refAuthor">Jacobs, F.</span>, and <span class="refAuthor">C. A. Wood</span>, <span class="refTitle">"RSA Blind Signatures"</span>, <span class="seriesInfo">RFC 9474</span>, <span class="seriesInfo">DOI 10.17487/RFC9474</span>, <time datetime="2023-10" class="refDate">October 2023</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc9474">https://www.rfc-editor.org/rfc/rfc9474</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="KVAC">[KVAC]</dt>
        <dd>
<span class="refTitle">"Keyed-Verification Anonymous Credentials from Algebraic MACs"</span>, <span>n.d.</span>, <span>&lt;<a href="https://eprint.iacr.org/2013/516">https://eprint.iacr.org/2013/516</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="NISTCurves">[NISTCurves]</dt>
        <dd>
<span class="refTitle">"Digital Signature Standard (DSS)"</span>, <span class="refContent">National Institute of Standards and Technology (U.S.)</span>, <span class="seriesInfo">DOI 10.6028/nist.fips.186-5</span>, <time datetime="2023-02" class="refDate">February 2023</time>, <span>&lt;<a href="https://doi.org/10.6028/nist.fips.186-5">https://doi.org/10.6028/nist.fips.186-5</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="OPRFS">[OPRFS]</dt>
        <dd>
<span class="refAuthor">Davidson, A.</span>, <span class="refAuthor">Faz-Hernandez, A.</span>, <span class="refAuthor">Sullivan, N.</span>, and <span class="refAuthor">C. A. Wood</span>, <span class="refTitle">"Oblivious Pseudorandom Functions (OPRFs) Using Prime-Order Groups"</span>, <span class="seriesInfo">RFC 9497</span>, <span class="seriesInfo">DOI 10.17487/RFC9497</span>, <time datetime="2023-12" class="refDate">December 2023</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc9497">https://www.rfc-editor.org/rfc/rfc9497</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="REVISITING_KVAC">[REVISITING_KVAC]</dt>
        <dd>
<span class="refTitle">"Revisiting Keyed-Verification Anonymous Credentials"</span>, <span>n.d.</span>, <span>&lt;<a href="https://eprint.iacr.org/2024/1552">https://eprint.iacr.org/2024/1552</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="SEC1">[SEC1]</dt>
      <dd>
<span class="refAuthor">Standards for Efficient Cryptography Group (SECG)</span>, <span class="refTitle">"SEC 1: Elliptic Curve Cryptography"</span>, <span>&lt;<a href="https://www.secg.org/sec1-v2.pdf">https://www.secg.org/sec1-v2.pdf</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
</div>
</section>
</div>
<div id="authors-addresses">
<section id="appendix-A">
      <h2 id="name-authors-addresses">
<a href="#name-authors-addresses" class="section-name selfRef">Authors' Addresses</a>
      </h2>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Cathie Yun</span></div>
<div dir="auto" class="left"><span class="org">Apple, Inc.</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:cathieyun@gmail.com" class="email">cathieyun@gmail.com</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Christopher A. Wood</span></div>
<div dir="auto" class="left"><span class="org">Apple, Inc.</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:caw@heapingbits.net" class="email">caw@heapingbits.net</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Armando Faz-Hernandez</span></div>
<div dir="auto" class="left"><span class="org">Cloudflare</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:armfazh@cloudflare.com" class="email">armfazh@cloudflare.com</a>
</div>
</address>
</section>
</div>
<script>const toc = document.getElementById("toc");
toc.querySelector("h2").addEventListener("click", e => {
  toc.classList.toggle("active");
});
toc.querySelector("nav").addEventListener("click", e => {
  toc.classList.remove("active");
});
</script>
</body>
</html>
